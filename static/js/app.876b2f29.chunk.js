(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{1006:function(e,t){},1009:function(e,t){},19:function(e,t,n){"use strict";n.r(t),t.default={}},630:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ur}));var r=n(0),a=n.n(r),i=n(9),c=n(262),o=n(161),l=n(6),s=n.n(l),u=n(154),d=n(140);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=j(j({},u.MD3LightTheme),{},{colors:j(j({},u.MD3LightTheme.colors),{},{primary:"#2B3A67",secondary:"#7B68EE",accent:"#00CED1",background:"#FFFFFF",surface:"#F5F5F5"}),fonts:Object(d.default)({config:{displayLarge:{fontFamily:"System",fontSize:57,fontWeight:"400",letterSpacing:0,lineHeight:64}}})}),b=n(1055),h=n(1054),m=n(4),g=n.n(m),O=n(5),y=n.n(O),v=n(3),x=n(2),C=n(25),w=n(539),S=n(143),_=(n(1025),n(636)),P=n(631),D=Object(P.createClient)("https://sedrnhyckkikgdyvrsxq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNlZHJuaHlja2tpa2dkeXZyc3hxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzkwMTk4OTYsImV4cCI6MjA1NDU5NTg5Nn0.sznIBYE-iZMEMFHnNHwr3-VPi2je_iwKFowK2nVtAZ0",{auth:{storage:_.default,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),T=(function(){var e=g()((function*(){try{var e=yield D.from("health_check").select("*").limit(1),t=(e.data,e.error);if(t)throw t;return!0}catch(t){return console.error("Database connection error:",t),!1}}))}(),function(){var e=g()((function*(e){try{var t=yield D.from(e).select("*",{count:"exact",head:!0}),n=t.count,r=t.error;if(r)throw r;return n||0}catch(r){return this.handleError(r),0}}))}(),function(){var e=g()((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;try{for(var r=0;r<t.length;r+=n){var a=t.slice(r,r+n),i=yield D.from(e).insert(a),c=i.error;if(c)throw c}}catch(c){this.handleError(c)}}))}(),function(){var e=g()((function*(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;try{for(var a=0;a<t.length;a+=r){var i=t.slice(a,a+r),c=yield D.from(e).upsert(i),o=c.error;if(o)throw o}}catch(o){this.handleError(o)}}))}(),{signUp:function(){var e=g()((function*(e,t,n,r){var a=yield D.auth.signUp({email:e,password:t,options:{data:{full_name:n,company_name:r,subscription_tier:"free"}}}),i=a.data,c=a.error;if(c)throw c;return i}));return function(t,n,r,a){return e.apply(this,arguments)}}(),signIn:function(){var e=g()((function*(e,t){var n=yield D.auth.signInWithPassword({email:e,password:t}),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),signOut:function(){var e=g()((function*(){var e=(yield D.auth.signOut()).error;if(e)throw e}));return function(){return e.apply(this,arguments)}}(),resetPassword:function(){var e=g()((function*(e){var t=(yield D.auth.resetPasswordForEmail(e)).error;if(t)throw t}));return function(t){return e.apply(this,arguments)}}()}),E=n(1),I=function(e){var t=e.navigation,n=Object(r.useState)(""),a=y()(n,2),i=a[0],c=a[1],o=Object(r.useState)(""),l=y()(o,2),s=l[0],u=l[1],d=Object(r.useState)(!1),f=y()(d,2),j=f[0],p=f[1],b=Object(r.useState)(""),h=y()(b,2),m=h[0],O=h[1],x=function(){var e=g()((function*(){if(i&&s)try{p(!0),O(""),yield T.signIn(i,s)}catch(e){O(e.message||"An error occurred")}finally{p(!1)}else O("Please fill in all fields")}));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(v.default,{style:k.container,children:[Object(E.jsx)(C.default,{variant:"headlineMedium",style:k.title,children:"Sign In"}),Object(E.jsx)(w.default,{label:"Email",value:i,onChangeText:c,mode:"outlined",style:k.input,autoCapitalize:"none",keyboardType:"email-address",autoComplete:"email"}),Object(E.jsx)(w.default,{label:"Password",value:s,onChangeText:u,mode:"outlined",style:k.input,secureTextEntry:!0,autoComplete:"password"}),m?Object(E.jsx)(C.default,{style:k.error,children:m}):null,Object(E.jsx)(S.default,{mode:"contained",onPress:x,loading:j,style:k.button,disabled:j,children:"Sign In"}),Object(E.jsx)(S.default,{mode:"text",onPress:function(){return t.navigate("SignUp")},disabled:j,children:"Don't have an account? Sign Up"})]})},k=x.default.create({container:{flex:1,padding:20,justifyContent:"center"},title:{textAlign:"center",marginBottom:20},input:{marginBottom:10},button:{marginTop:10,marginBottom:10},error:{color:"red",marginBottom:10}}),B=function(e){var t=e.navigation,n=Object(r.useState)(""),a=y()(n,2),i=a[0],c=a[1],o=Object(r.useState)(""),l=y()(o,2),s=l[0],u=l[1],d=Object(r.useState)(""),f=y()(d,2),j=f[0],p=f[1],b=Object(r.useState)(""),h=y()(b,2),m=h[0],O=h[1],x=Object(r.useState)(!1),_=y()(x,2),P=_[0],D=_[1],I=Object(r.useState)(""),k=y()(I,2),B=k[0],L=k[1],M=function(){var e=g()((function*(){if(i&&s&&j&&m)try{D(!0),L(""),yield T.signUp(i,s,j,m)}catch(e){L(e.message||"An error occurred")}finally{D(!1)}else L("Please fill in all fields")}));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(v.default,{style:A.container,children:[Object(E.jsx)(C.default,{variant:"headlineMedium",style:A.title,children:"Sign Up"}),Object(E.jsx)(w.default,{label:"Full Name",value:j,onChangeText:p,mode:"outlined",style:A.input,autoComplete:"name"}),Object(E.jsx)(w.default,{label:"Company Name",value:m,onChangeText:O,mode:"outlined",style:A.input}),Object(E.jsx)(w.default,{label:"Email",value:i,onChangeText:c,mode:"outlined",style:A.input,autoCapitalize:"none",keyboardType:"email-address",autoComplete:"email"}),Object(E.jsx)(w.default,{label:"Password",value:s,onChangeText:u,mode:"outlined",style:A.input,secureTextEntry:!0,autoComplete:"password-new"}),B?Object(E.jsx)(C.default,{style:A.error,children:B}):null,Object(E.jsx)(S.default,{mode:"contained",onPress:M,loading:P,style:A.button,disabled:P,children:"Sign Up"}),Object(E.jsx)(S.default,{mode:"text",onPress:function(){return t.navigate("SignIn")},disabled:P,children:"Already have an account? Sign In"})]})},A=x.default.create({container:{flex:1,padding:20,justifyContent:"center"},title:{textAlign:"center",marginBottom:20},input:{marginBottom:10},button:{marginTop:10,marginBottom:10},error:{color:"red",marginBottom:10}}),L=n(270),M=Object(r.createContext)({user:null,session:null,loading:!0}),R=function(e){var t=e.children,n=Object(r.useState)(null),a=y()(n,2),i=a[0],c=a[1],o=Object(r.useState)(null),l=y()(o,2),s=l[0],u=l[1],d=Object(r.useState)(!0),f=y()(d,2),j=f[0],p=f[1];return Object(r.useEffect)((function(){D.auth.getSession().then((function(e){var t=e.data.session;u(t),c(null==t?void 0:t.user),p(!1)}));var e=D.auth.onAuthStateChange((function(e,t){u(t),c(null==t?void 0:t.user),p(!1)})).data.subscription;return function(){return e.unsubscribe()}}),[]),Object(E.jsx)(M.Provider,{value:{user:i,session:s,loading:j},children:t})},q=function(){var e=Object(r.useContext)(M);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},F=function(e){var t=e.navigation,n=q().user,r=a.a.useState(!1),i=y()(r,2),c=i[0],o=i[1],l=function(){var e=g()((function*(){try{o(!0),yield T.signOut()}catch(e){console.error("Error signing out:",e)}finally{o(!1)}}));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)("div",{style:N.container,children:[Object(E.jsxs)("div",{style:N.header,children:[Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Dashboard"}),Object(E.jsx)(S.default,{mode:"outlined",onPress:l,loading:c,disabled:c,children:"Sign Out"})]}),Object(E.jsxs)("div",{style:N.content,children:[Object(E.jsxs)(L.default,{style:N.card,children:[Object(E.jsx)(L.default.Title,{title:"Welcome",subtitle:null==n?void 0:n.full_name}),Object(E.jsxs)(L.default.Content,{children:[Object(E.jsxs)(C.default,{variant:"bodyMedium",children:["Company: ",null==n?void 0:n.company_name]}),Object(E.jsxs)(C.default,{variant:"bodyMedium",children:["Subscription: ",null==n?void 0:n.subscription_tier]})]})]}),Object(E.jsxs)(L.default,{style:N.card,children:[Object(E.jsx)(L.default.Title,{title:"Quick Actions"}),Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(S.default,{mode:"contained",style:N.actionButton,onPress:function(){return t.navigate("Campaigns")},children:"Manage Campaigns"}),Object(E.jsx)(S.default,{mode:"contained",style:N.actionButton,onPress:function(){return t.navigate("Contacts")},children:"Manage Contacts"})]})]}),Object(E.jsxs)(L.default,{style:N.card,children:[Object(E.jsx)(L.default.Title,{title:"Recent Activity"}),Object(E.jsx)(L.default.Content,{children:Object(E.jsx)(C.default,{variant:"bodyMedium",children:"No recent activity"})})]})]})]})},N=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5",height:"100vh"},header:{padding:16,backgroundColor:"#fff",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #eee"},content:{flex:1,padding:16,overflow:"auto"},card:{marginBottom:16},actionButton:{marginBottom:8}}),V=n(21),z=n.n(V),H=n(91),G=n(72),U=n(394),W=n(544),J=n(186),K=n(541),Y=n(55);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=Y.z.object({id:Y.z.string().optional(),first_name:Y.z.string().min(1,"First name is required"),last_name:Y.z.string().min(1,"Last name is required"),phone_number:Y.z.string().regex(/^\+?[1-9]\d{1,14}$/,"Invalid phone number"),email:Y.z.string().email().nullable(),company:Y.z.string().nullable(),job_title:Y.z.string().nullable(),tags:Y.z.array(Y.z.string()),notes:Y.z.string().nullable(),do_not_call:Y.z.boolean(),created_at:Y.z.string().optional(),updated_at:Y.z.string().optional()}),$={getContacts:function(){var e=g()((function*(){var e=yield D.from("contacts").select("*").order("created_at",{ascending:!1}),t=e.data,n=e.error;if(n)throw n;return t}));return function(){return e.apply(this,arguments)}}(),getContact:function(){var e=g()((function*(e){var t=yield D.from("contacts").select("*").eq("id",e).single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),createContact:function(){var e=g()((function*(e){var t=Q.omit({id:!0,created_at:!0,updated_at:!0}).parse(e),n=yield D.from("contacts").insert([t]).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t){return e.apply(this,arguments)}}(),updateContact:function(){var e=g()((function*(e,t){var n=Q.partial().parse(t),r=yield D.from("contacts").update(n).eq("id",e).select().single(),a=r.data,i=r.error;if(i)throw i;return a}));return function(t,n){return e.apply(this,arguments)}}(),deleteContact:function(){var e=g()((function*(e){var t=(yield D.from("contacts").delete().eq("id",e)).error;if(t)throw t}));return function(t){return e.apply(this,arguments)}}(),searchContacts:function(){var e=g()((function*(e){var t=yield D.from("contacts").select("*").or("first_name.ilike.%"+e+"%,last_name.ilike.%"+e+"%,phone_number.ilike.%"+e+"%").order("created_at",{ascending:!1}),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),getContactsByTag:function(){var e=g()((function*(e){var t=yield D.from("contacts").select("*").contains("tags",[e]).order("created_at",{ascending:!1}),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),getLists:function(){var e=g()((function*(){var e=yield D.from("contact_lists").select("*").order("created_at",{ascending:!1}),t=e.data,n=e.error;if(n)throw n;return t}));return function(){return e.apply(this,arguments)}}(),createList:function(){var e=g()((function*(e){var t=yield D.from("contact_lists").insert([e]).select().single(),n=t.data,r=t.error;if(r)throw r;return X(X({},n),{},{contact_count:0})}));return function(t){return e.apply(this,arguments)}}(),updateList:function(){var e=g()((function*(e,t){var n=yield D.from("contact_lists").update(X(X({},t),{},{updated_at:(new Date).toISOString()})).eq("id",e).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),deleteList:function(){var e=g()((function*(e){var t=(yield D.from("contact_lists").delete().eq("id",e)).error;if(t)throw t}));return function(t){return e.apply(this,arguments)}}(),addContactsToList:function(){var e=g()((function*(e,t){var n=t.map((function(t){return{list_id:e,contact_id:t,added_at:(new Date).toISOString()}})),r=(yield D.from("contact_list_members").upsert(n)).error;if(r)throw r}));return function(t,n){return e.apply(this,arguments)}}(),removeContactsFromList:function(){var e=g()((function*(e,t){var n=(yield D.from("contact_list_members").delete().eq("list_id",e).in("contact_id",t)).error;if(n)throw n}));return function(t,n){return e.apply(this,arguments)}}(),importContacts:function(){var e=g()((function*(e){for(var t=[],n=0;n<e.length;n+=100)t.push(e.slice(n,n+100));var r=[];for(var a of t){var i=yield D.from("contacts").insert(a).select(),c=i.data,o=i.error;if(o)throw o;r.push.apply(r,z()(c))}return r}));return function(t){return e.apply(this,arguments)}}(),getListContacts:function(){var e=g()((function*(e){var t=yield D.from("contacts").select("\n        contacts.*,\n        contact_list_members!inner(*)\n      ").eq("contact_list_members.list_id",e),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),shareList:function(){var e=g()((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"read",r=yield D.from("profiles").select("id").eq("email",t).single(),a=r.data,i=r.error;if(i)throw i;if(!a)throw new Error("User not found");var c=yield D.from("shared_lists").insert([{list_id:e,shared_with:a.id,permissions:n}]).select().single(),o=c.data,l=c.error;if(l)throw l;return o}));return function(t,n){return e.apply(this,arguments)}}(),getSharedLists:function(){var e=g()((function*(){var e=yield D.from("shared_lists").select("\n        *,\n        contact_lists(*),\n        shared_by:profiles!shared_lists_shared_by_fkey(email, full_name)\n      ").order("created_at",{ascending:!1}),t=e.data,n=e.error;if(n)throw n;return t}));return function(){return e.apply(this,arguments)}}(),removeSharing:function(){var e=g()((function*(e){var t=(yield D.from("shared_lists").delete().eq("id",e)).error;if(t)throw t}));return function(t){return e.apply(this,arguments)}}()},ee=n(33),te=n(546),ne=n(547),re=n(548);function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){var t=e.contact,n=e.onSubmit,a=e.onCancel,i=e.loading,c=r.useState({first_name:(null==t?void 0:t.first_name)||"",last_name:(null==t?void 0:t.last_name)||"",phone_number:(null==t?void 0:t.phone_number)||"",email:(null==t?void 0:t.email)||"",company:(null==t?void 0:t.company)||"",job_title:(null==t?void 0:t.job_title)||"",tags:(null==t?void 0:t.tags)||[],notes:(null==t?void 0:t.notes)||"",do_not_call:(null==t?void 0:t.do_not_call)||!1}),o=y()(c,2),l=o[0],s=o[1],u=r.useState(""),d=y()(u,2),f=d[0],j=d[1],p=r.useState(""),b=y()(p,2),h=b[0],m=b[1],O=function(){var e=g()((function*(){if(l.first_name&&l.last_name&&l.phone_number)try{yield n(l)}catch(e){j(e.message||"An error occurred")}else j("Please fill in all required fields")}));return function(){return e.apply(this,arguments)}}(),x=function(){h&&!l.tags.includes(h)&&(s((function(e){return ie(ie({},e),{},{tags:[].concat(z()(e.tags),[h])})})),m(""))};return Object(E.jsxs)(ee.default,{style:oe.container,children:[Object(E.jsx)(w.default,{label:"First Name *",value:l.first_name,onChangeText:function(e){return s((function(t){return ie(ie({},t),{},{first_name:e})}))},mode:"outlined",style:oe.input}),Object(E.jsx)(w.default,{label:"Last Name *",value:l.last_name,onChangeText:function(e){return s((function(t){return ie(ie({},t),{},{last_name:e})}))},mode:"outlined",style:oe.input}),Object(E.jsx)(w.default,{label:"Phone Number *",value:l.phone_number,onChangeText:function(e){return s((function(t){return ie(ie({},t),{},{phone_number:e})}))},mode:"outlined",keyboardType:"phone-pad",style:oe.input}),Object(E.jsx)(w.default,{label:"Email",value:l.email,onChangeText:function(e){return s((function(t){return ie(ie({},t),{},{email:e})}))},mode:"outlined",keyboardType:"email-address",style:oe.input}),Object(E.jsx)(w.default,{label:"Company",value:l.company,onChangeText:function(e){return s((function(t){return ie(ie({},t),{},{company:e})}))},mode:"outlined",style:oe.input}),Object(E.jsx)(w.default,{label:"Job Title",value:l.job_title,onChangeText:function(e){return s((function(t){return ie(ie({},t),{},{job_title:e})}))},mode:"outlined",style:oe.input}),Object(E.jsxs)(v.default,{style:oe.tagsContainer,children:[Object(E.jsx)(w.default,{label:"Add Tag",value:h,onChangeText:m,onSubmitEditing:x,mode:"outlined",right:Object(E.jsx)(w.default.Icon,{icon:"plus",onPress:x}),style:oe.tagInput}),Object(E.jsx)(v.default,{style:oe.tagList,children:l.tags.map((function(e){return Object(E.jsx)(te.default,{onClose:function(){return function(e){s((function(t){return ie(ie({},t),{},{tags:t.tags.filter((function(t){return t!==e}))})}))}(e)},style:oe.tag,children:e},e)}))})]}),Object(E.jsx)(w.default,{label:"Notes",value:l.notes,onChangeText:function(e){return s((function(t){return ie(ie({},t),{},{notes:e})}))},mode:"outlined",multiline:!0,numberOfLines:4,style:oe.input}),Object(E.jsxs)(v.default,{style:oe.switchContainer,children:[Object(E.jsx)(ne.default,{value:l.do_not_call,onValueChange:function(e){return s((function(t){return ie(ie({},t),{},{do_not_call:e})}))}}),Object(E.jsx)(Text,{children:"Do Not Call"})]}),f?Object(E.jsx)(re.default,{type:"error",children:f}):null,Object(E.jsxs)(v.default,{style:oe.buttons,children:[Object(E.jsx)(S.default,{mode:"outlined",onPress:a,style:oe.button,children:"Cancel"}),Object(E.jsx)(S.default,{mode:"contained",onPress:O,loading:i,disabled:i,style:oe.button,children:t?"Update":"Create"})]})]})},oe=x.default.create({container:{flex:1,padding:16},input:{marginBottom:12},tagsContainer:{marginBottom:12},tagInput:{marginBottom:8},tagList:{flexDirection:"row",flexWrap:"wrap"},tag:{margin:4},switchContainer:{flexDirection:"row",alignItems:"center",marginBottom:16},buttons:{flexDirection:"row",justifyContent:"flex-end",gap:8},button:{minWidth:100}});function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=function(e){var t=e.navigation,n=Object(r.useState)([]),a=y()(n,2),i=a[0],c=a[1],o=Object(r.useState)(!0),l=y()(o,2),s=l[0],u=l[1],d=Object(r.useState)(""),f=y()(d,2),j=f[0],p=f[1],b=Object(r.useState)(!1),h=y()(b,2),m=h[0],O=h[1],x=Object(r.useState)(null),w=y()(x,2),_=w[0],P=w[1];Object(r.useEffect)((function(){D()}),[]);var D=function(){var e=g()((function*(){try{u(!0);var e=yield $.getContacts();c(e)}catch(t){console.error("Error loading contacts:",t)}finally{u(!1)}}));return function(){return e.apply(this,arguments)}}(),T=function(){var e=g()((function*(e){try{var t=yield $.addContact(e);c([t].concat(z()(i))),O(!1)}catch(n){console.error("Error adding contact:",n)}}));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=g()((function*(e,t){try{var n=yield $.updateContact(e,t);c(i.map((function(t){return t.id===e?n:t}))),P(null)}catch(r){console.error("Error updating contact:",r)}}));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=g()((function*(e){try{yield $.deleteContact(e),c(i.filter((function(t){return t.id!==e})))}catch(t){console.error("Error deleting contact:",t)}}));return function(t){return e.apply(this,arguments)}}(),B=i.filter((function(e){return(e.first_name+" "+e.last_name+" "+e.company).toLowerCase().includes(j.toLowerCase())}));return Object(E.jsxs)(v.default,{style:de.container,children:[Object(E.jsxs)(v.default,{style:de.header,children:[Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Contacts"}),Object(E.jsx)(S.default,{mode:"contained",onPress:function(){return t.goBack()},children:"Back"})]}),Object(E.jsx)(U.default,{placeholder:"Search contacts",onChangeText:p,value:j,style:de.searchbar}),Object(E.jsx)(H.default,{data:B,renderItem:function(e){var t=e.item;return Object(E.jsxs)(L.default,{style:de.card,children:[Object(E.jsx)(L.default.Title,{title:t.first_name+" "+t.last_name,subtitle:t.company,right:function(e){return Object(E.jsxs)(v.default,{style:{flexDirection:"row"},children:[Object(E.jsx)(G.default,se(se({},e),{},{icon:"pencil",onPress:function(){return P(t)}})),Object(E.jsx)(G.default,se(se({},e),{},{icon:"delete",onPress:function(){return k(t.id)}}))]})}}),Object(E.jsxs)(L.default.Content,{children:[Object(E.jsxs)(C.default,{children:["Email: ",t.email]}),Object(E.jsxs)(C.default,{children:["Phone: ",t.phone]}),Object(E.jsxs)(C.default,{children:["Status: ",t.status]})]})]})},keyExtractor:function(e){return e.id},contentContainerStyle:de.list,refreshing:s,onRefresh:D}),Object(E.jsx)(W.default,{icon:"plus",style:de.fab,onPress:function(){return O(!0)}}),Object(E.jsxs)(J.default,{children:[Object(E.jsxs)(K.default,{visible:m,onDismiss:function(){return O(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Add New Contact"}),Object(E.jsx)(K.default.Content,{children:Object(E.jsx)(ce,{onSubmit:T,onCancel:function(){return O(!1)}})})]}),Object(E.jsxs)(K.default,{visible:!!_,onDismiss:function(){return P(null)},children:[Object(E.jsx)(K.default.Title,{children:"Edit Contact"}),Object(E.jsx)(K.default.Content,{children:_&&Object(E.jsx)(ce,{contact:_,onSubmit:function(e){return I(_.id,e)},onCancel:function(){return P(null)}})})]})]})]})},de=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{padding:16,backgroundColor:"#fff",flexDirection:"row",justifyContent:"space-between",alignItems:"center",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:2},searchbar:{margin:16},list:{padding:16},card:{marginBottom:16},fab:{position:"absolute",margin:16,right:0,bottom:0}});function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pe={getSettings:function(){var e=g()((function*(e){var t=yield D.from("campaign_settings").select("*").eq("campaign_id",e).single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),updateSettings:function(){var e=g()((function*(e,t){var n=yield D.from("campaign_settings").update(je(je({},t),{},{updated_at:(new Date).toISOString()})).eq("campaign_id",e).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),createSettings:function(){var e=g()((function*(e){var t=yield D.from("campaign_settings").insert([e]).select().single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}()};function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me={getSchedule:function(){var e=g()((function*(e){var t=yield D.from("campaign_schedules").select("*").eq("campaign_id",e).single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),createSchedule:function(){var e=g()((function*(e){var t=yield D.from("campaign_schedules").insert([e]).select().single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),updateSchedule:function(){var e=g()((function*(e,t){var n=yield D.from("campaign_schedules").update(he(he({},t),{},{updated_at:(new Date).toISOString()})).eq("id",e).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),deleteSchedule:function(){var e=g()((function*(e){var t=(yield D.from("campaign_schedules").delete().eq("id",e)).error;if(t)throw t}));return function(t){return e.apply(this,arguments)}}()};function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ye={getCampaigns:function(){var e=g()((function*(){var e=yield D.from("campaigns").select("*").order("created_at",{ascending:!1}),t=e.data,n=e.error;if(n)throw n;return t}));return function(){return e.apply(this,arguments)}}(),getCampaign:function(){var e=g()((function*(e){var t=yield D.from("campaigns").select("*").eq("id",e).single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),createCampaign:function(){var e=g()((function*(e){var t=yield D.auth.getUser(),n=t.data,r=t.error;if(r)throw r;var a=yield D.from("campaigns").insert([Oe(Oe({},e),{},{user_id:n.user.id,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()})]).select().single(),i=a.data,c=a.error;if(c)throw c;return yield pe.createSettings({campaign_id:i.id,max_calls_per_day:50,time_zone:"UTC",working_hours:{start:"09:00",end:"17:00"},voice_settings:{voice_id:"default",speed:1,pitch:0,language:"en-US"},call_handling:{max_retries:3,retry_interval:60,voicemail_behavior:"leave_message",recording_enabled:!0}}),yield me.createSchedule({campaign_id:i.id,schedule_type:"one_time",start_date:e.start_date,daily_start_time:"09:00",daily_end_time:"17:00",max_concurrent_calls:5,status:"active",days_of_week:[1,2,3,4,5]}),i}));return function(t){return e.apply(this,arguments)}}(),updateCampaign:function(){var e=g()((function*(e,t){var n=yield D.from("campaigns").update(Oe(Oe({},t),{},{updated_at:(new Date).toISOString()})).eq("id",e).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),deleteCampaign:function(){var e=g()((function*(e){yield Promise.all([D.from("campaign_settings").delete().eq("campaign_id",e),D.from("campaign_schedules").delete().eq("campaign_id",e),D.from("call_records").delete().eq("campaign_id",e)]);var t=(yield D.from("campaigns").delete().eq("id",e)).error;if(t)throw t}));return function(t){return e.apply(this,arguments)}}(),updateStatus:function(){var e=g()((function*(e,t){var n=yield D.from("campaigns").update({status:t,updated_at:(new Date).toISOString()}).eq("id",e).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),getAnalytics:function(){var e=g()((function*(e){var t=yield D.from("call_records").select("\n        status,\n        duration,\n        created_at,\n        contacts (\n          first_name,\n          last_name,\n          company\n        )\n      ").eq("campaign_id",e),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}()},ve=function(e){var t=e.navigation,n=Object(r.useState)([]),a=y()(n,2),i=a[0],c=a[1],o=Object(r.useState)(!0),l=y()(o,2),s=(l[0],l[1]),u=Object(r.useState)(""),d=y()(u,2),f=(d[0],d[1]),j=Object(r.useState)(""),p=y()(j,2),b=p[0],h=p[1],m=Object(r.useState)(!1),O=y()(m,2),x=O[0],w=O[1],_=Object(r.useState)(null),P=y()(_,2),D=P[0],T=P[1];Object(r.useEffect)((function(){I()}),[]);var I=function(){var e=g()((function*(){try{s(!0);var e=yield ye.getCampaigns();c(e)}catch(t){f(t.message||"Failed to load campaigns")}finally{s(!1)}}));return function(){return e.apply(this,arguments)}}(),k=function(){var e=g()((function*(e,t){try{var n=yield ye.updateStatus(e,t);c((function(t){return t.map((function(t){return t.id===e?n:t}))}))}catch(r){console.error("Error updating campaign status:",r)}}));return function(t,n){return e.apply(this,arguments)}}(),B=function(){var e=g()((function*(){if(D)try{yield ye.deleteCampaign(D.id),c((function(e){return e.filter((function(e){return e.id!==D.id}))})),w(!1),T(null)}catch(e){console.error("Error deleting campaign:",e)}}));return function(){return e.apply(this,arguments)}}(),A=i.filter((function(e){return e.name.toLowerCase().includes(b.toLowerCase())})),M=function(e){switch(e){case"active":return"success";case"paused":return"warning";case"draft":return"default";case"completed":return"info";default:return"default"}};return Object(E.jsxs)(v.default,{style:xe.container,children:[Object(E.jsx)(v.default,{style:xe.header,children:Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Campaigns"})}),Object(E.jsx)(U.default,{placeholder:"Search campaigns...",onChangeText:h,value:b,style:xe.searchbar}),Object(E.jsx)(H.default,{data:A,keyExtractor:function(e){return e.id},contentContainerStyle:xe.list,renderItem:function(e){var n=e.item;return Object(E.jsxs)(L.default,{style:xe.card,children:[Object(E.jsxs)(L.default.Content,{children:[Object(E.jsxs)(v.default,{style:xe.cardHeader,children:[Object(E.jsx)(C.default,{variant:"titleLarge",children:n.name}),Object(E.jsx)(te.default,{mode:"outlined",textStyle:{color:M(n.status)},children:n.status})]}),Object(E.jsxs)(C.default,{variant:"bodyMedium",children:["Start Date: ",new Date(n.start_date).toLocaleDateString()]}),n.end_date&&Object(E.jsxs)(C.default,{variant:"bodyMedium",children:["End Date: ",new Date(n.end_date).toLocaleDateString()]})]}),Object(E.jsxs)(L.default.Actions,{children:[Object(E.jsx)(S.default,{onPress:function(){return t.navigate("CampaignEdit",{id:n.id})},children:"Edit"}),"active"!==n.status&&Object(E.jsx)(S.default,{mode:"contained",onPress:function(){return k(n.id,"active")},children:"Start"}),"active"===n.status&&Object(E.jsx)(S.default,{mode:"contained",onPress:function(){return k(n.id,"paused")},children:"Pause"}),Object(E.jsx)(G.default,{icon:"delete",onPress:function(){T(n),w(!0)}})]})]})}}),Object(E.jsx)(W.default,{icon:"plus",onPress:function(){return t.navigate("CampaignCreate")},style:xe.fab}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:x,onDismiss:function(){return w(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Delete Campaign"}),Object(E.jsx)(K.default.Content,{children:Object(E.jsx)(C.default,{children:"Are you sure you want to delete this campaign? This action cannot be undone."})}),Object(E.jsxs)(K.default.Actions,{children:[Object(E.jsx)(S.default,{onPress:function(){return w(!1)},children:"Cancel"}),Object(E.jsx)(S.default,{onPress:B,textColor:"#dc3545",children:"Delete"})]})]})})]})},xe=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},searchbar:{margin:16},list:{padding:16},card:{marginBottom:16},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},fab:{position:"absolute",margin:16,right:0,bottom:0}}),Ce=n(152),we=n(185),Se=n(204),_e=n(545),Pe=n(13),De=n.n(Pe),Te=n(14),Ee=n.n(Te),Ie={DEEPSEEK_API_URL:"https://api.deepseek.com/v1",DEEPSEEK_API_KEY:Object({NODE_ENV:"production",PUBLIC_URL:"/cold-calling-ai",APP_MANIFEST:{permissions:["NOTIFICATIONS","CAMERA","AUDIO_RECORDING","READ_EXTERNAL_STORAGE","WRITE_EXTERNAL_STORAGE"],name:"cold-calling-ai",slug:"cold-calling-ai",version:"1.0.0",sdkVersion:"47.0.0",platforms:["ios","android","web"],web:{}}}).DEEPSEEK_API_KEY||"your_api_key_here",MODELS:{SCRIPT_GENERATION:"deepseek-chat"}},ke=function(){function e(){De()(this,e),this.apiKey=Ie.DEEPSEEK_API_KEY,this.baseUrl=Ie.DEEPSEEK_API_URL}return Ee()(e,[{key:"generateCompletion",value:function(){var e=g()((function*(e){try{var t=yield fetch(this.baseUrl+"/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.apiKey},body:JSON.stringify({model:e.model,messages:e.messages,temperature:e.temperature||.7,max_tokens:e.max_tokens||2e3})});if(!t.ok){var n=yield t.json();throw new Error(n.message||"Failed to generate completion")}return(yield t.json()).choices[0].message.content}catch(n){throw new Error("AI completion failed: "+n.message)}}));return function(t){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}(),Be={generateScript:function(){var e=g()((function*(e){try{var t=ke.getInstance(),n="You are an expert AI sales script writer. \nCreate a natural, conversational cold calling script for the following context:\n- Industry: "+e.industry+"\n- Product/Service: "+e.product+"\n- Target Audience: "+e.targetAudience+"\n- Tone: "+(e.tone||"professional")+"\n- Language: "+(e.language||"English")+"\n\nThe script should:\n1. Have a natural opening that doesn't sound scripted\n2. Include handling common objections\n3. Have clear value propositions\n4. Include qualifying questions\n5. Have a strong call to action\n6. Sound human and conversational\n7. Include branching paths for different responses\n8. Use appropriate tone and language for the industry\n\nFormat the script with clear sections and response handlers in [brackets].",r="Generate a cold calling script that will be used by an AI voice bot. \nMake it sound natural and conversational, avoiding obvious sales language.\nInclude specific value propositions for "+e.product+" in the "+e.industry+" industry.";return yield t.generateCompletion({model:Ie.MODELS.SCRIPT_GENERATION,messages:[{role:"system",content:n},{role:"user",content:r}],temperature:.7})}catch(a){throw new Error("Failed to generate script: "+a.message)}}));return function(t){return e.apply(this,arguments)}}(),saveGeneratedScript:function(){var e=g()((function*(e,t,n){var r=(yield D.from("generated_scripts").insert([{id:e,content:t,metadata:n,created_at:(new Date).toISOString()}])).error;if(r)throw r}));return function(t,n,r){return e.apply(this,arguments)}}(),getScriptHistory:function(){var e=g()((function*(){var e=yield D.from("generated_scripts").select("*").order("created_at",{ascending:!1}),t=e.data,n=e.error;if(n)throw n;return t}));return function(){return e.apply(this,arguments)}}()},Ae=n(27);function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re={getTemplates:function(){var e=g()((function*(){var e=yield D.from("script_templates").select("*").order("created_at",{ascending:!1}),t=e.data,n=e.error;if(n)throw n;return t}));return function(){return e.apply(this,arguments)}}(),getTemplate:function(){var e=g()((function*(e){var t=yield D.from("script_templates").select("*").eq("id",e).single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),createTemplate:function(){var e=g()((function*(e){var t=yield D.from("script_templates").insert([e]).select().single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),updateTemplate:function(){var e=g()((function*(e,t){var n=yield D.from("script_templates").update(Me(Me({},t),{},{updated_at:(new Date).toISOString()})).eq("id",e).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),deleteTemplate:function(){var e=g()((function*(e){var t=(yield D.from("script_templates").delete().eq("id",e)).error;if(t)throw t}));return function(t){return e.apply(this,arguments)}}()};function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne=function(e){var t=e.onSelectTemplate,n=Object(r.useState)([]),a=y()(n,2),i=a[0],c=a[1],o=Object(r.useState)(!0),l=y()(o,2),s=l[0],u=l[1],d=Object(r.useState)(""),f=y()(d,2),j=f[0],p=f[1],b=Object(r.useState)(!1),h=y()(b,2),m=h[0],O=h[1],x=Object(r.useState)(""),_=y()(x,2),P=_[0],D=_[1],T=Object(r.useState)(""),I=y()(T,2),k=I[0],B=I[1];Object(r.useEffect)((function(){A()}),[]);var A=function(){var e=g()((function*(){try{u(!0);var e=yield Re.getTemplates();c(e)}catch(t){p(t.message||"Failed to load templates")}finally{u(!1)}}));return function(){return e.apply(this,arguments)}}(),L=function(){var e=g()((function*(){if(P)try{u(!0);var e=yield Re.createTemplate({name:P,description:k,content:"",metadata:{industry:"",product:"",targetAudience:""},is_default:!1});c([e].concat(z()(i))),O(!1),D(""),B("")}catch(t){p(t.message||"Failed to save template")}finally{u(!1)}else p("Please enter a template name")}));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(v.default,{style:Ve.container,children:[Object(E.jsxs)(v.default,{style:Ve.header,children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Script Templates"}),Object(E.jsx)(S.default,{mode:"outlined",onPress:function(){return O(!0)},children:"Save as Template"})]}),Object(E.jsx)(ee.default,{children:i.map((function(e){return Object(E.jsx)(Ae.List.Item,{title:e.name,description:e.description,left:function(e){return Object(E.jsx)(Ae.List.Icon,Fe(Fe({},e),{},{icon:"file-document-outline"}))},onPress:function(){return t(e)}},e.id)}))}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:m,onDismiss:function(){return O(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Save as Template"}),Object(E.jsxs)(K.default.Content,{children:[Object(E.jsx)(w.default,{label:"Template Name",value:P,onChangeText:D,mode:"outlined",style:Ve.input}),Object(E.jsx)(w.default,{label:"Description",value:k,onChangeText:B,mode:"outlined",multiline:!0,numberOfLines:3,style:Ve.input}),j?Object(E.jsx)(re.default,{type:"error",children:j}):null]}),Object(E.jsxs)(K.default.Actions,{children:[Object(E.jsx)(S.default,{onPress:function(){return O(!1)},children:"Cancel"}),Object(E.jsx)(S.default,{onPress:L,loading:s,children:"Save"})]})]})})]})},Ve=x.default.create({container:{flex:1},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,paddingHorizontal:16},input:{marginBottom:12}}),ze=function(e){var t=e.onGenerate,n=e.onCancel,a=Object(r.useState)(""),i=y()(a,2),c=i[0],o=i[1],l=Object(r.useState)(""),s=y()(l,2),u=s[0],d=s[1],f=Object(r.useState)(""),j=y()(f,2),p=j[0],b=j[1],h=Object(r.useState)("professional"),m=y()(h,2),O=m[0],x=m[1],C=Object(r.useState)(!1),_=y()(C,2),P=_[0],D=_[1],T=Object(r.useState)(""),I=y()(T,2),k=I[0],B=I[1],A=Object(r.useState)(!1),L=y()(A,2),M=L[0],R=L[1],q=Object(r.useState)(!1),F=y()(q,2),N=F[0],V=F[1],z=function(){var e=g()((function*(){if(c&&u&&p)try{R(!0),B(""),D(!0);var e=yield Be.generateScript({industry:c,product:u,targetAudience:p,tone:O});yield Be.saveGeneratedScript(Date.now().toString(),e,{industry:c,product:u,targetAudience:p,tone:O}),t(e)}catch(n){B(n.message||"Failed to generate script")}finally{R(!1),D(!1)}else B("Please fill in all fields")}));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(ee.default,{children:[Object(E.jsx)(w.default,{label:"Industry",value:c,onChangeText:o,mode:"outlined",style:He.input,placeholder:"e.g., Software, Healthcare, Manufacturing"}),Object(E.jsx)(w.default,{label:"Product/Service",value:u,onChangeText:d,mode:"outlined",style:He.input,placeholder:"e.g., CRM Software, Medical Equipment"}),Object(E.jsx)(w.default,{label:"Target Audience",value:p,onChangeText:b,mode:"outlined",style:He.input,placeholder:"e.g., IT Managers, Healthcare Administrators"}),Object(E.jsx)(_e.default,{value:O,onValueChange:function(e){return x(e)},buttons:[{value:"professional",label:"Professional"},{value:"friendly",label:"Friendly"},{value:"casual",label:"Casual"}],style:He.segmentedButtons}),Object(E.jsx)(S.default,{mode:"outlined",onPress:function(){return V(!0)},style:He.input,children:"Load from Template"}),k?Object(E.jsx)(re.default,{type:"error",children:k}):null,Object(E.jsxs)(v.default,{style:He.buttons,children:[Object(E.jsx)(S.default,{mode:"outlined",onPress:n,style:He.button,disabled:P,children:"Cancel"}),Object(E.jsx)(S.default,{mode:"contained",onPress:z,loading:P,disabled:P,style:He.button,children:"Generate"})]}),M&&Object(E.jsxs)(v.default,{style:He.loadingContainer,children:[Object(E.jsx)(we.default,{size:"large"}),Object(E.jsx)(Text,{style:He.loadingText,children:"Generating script..."})]}),Object(E.jsx)(Se.Portal,{children:Object(E.jsxs)(Se.Dialog,{visible:N,onDismiss:function(){return V(!1)},children:[Object(E.jsx)(Se.Dialog.Title,{children:"Script Templates"}),Object(E.jsx)(Se.Dialog.Content,{children:Object(E.jsx)(Ne,{onSelectTemplate:function(e){o(e.metadata.industry),d(e.metadata.product),b(e.metadata.targetAudience),e.metadata.tone&&x(e.metadata.tone),V(!1)}})})]})})]})},He=x.default.create({input:{marginBottom:12},segmentedButtons:{marginBottom:16},buttons:{flexDirection:"row",justifyContent:"flex-end",marginTop:16},button:{marginLeft:8},loadingContainer:{alignItems:"center",marginVertical:16},loadingText:{marginTop:8}}),Ge=function(e){var t=e.navigation,n=Object(r.useState)(""),a=y()(n,2),i=a[0],c=a[1],o=Object(r.useState)(""),l=y()(o,2),s=l[0],u=l[1],d=Object(r.useState)(new Date),f=y()(d,2),j=f[0],p=f[1],b=Object(r.useState)(!1),h=y()(b,2),m=h[0],O=h[1],x=Object(r.useState)(!1),_=y()(x,2),P=_[0],D=_[1],T=Object(r.useState)(""),I=y()(T,2),k=I[0],B=I[1],A=Object(r.useState)(!1),L=y()(A,2),M=L[0],R=L[1],q=function(){var e=g()((function*(){if(i&&s)try{D(!0),B("");var e={name:i,script:s,status:"draft",start_date:j.toISOString(),end_date:null,settings:{max_calls_per_day:50,time_zone:"UTC",working_hours:{start:"09:00",end:"17:00"}}};yield ye.createCampaign(e),t.goBack()}catch(n){B(n.message||"An error occurred")}finally{D(!1)}else B("Please fill in all required fields")}));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(v.default,{style:Ue.container,children:[Object(E.jsx)(v.default,{style:Ue.header,children:Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Create Campaign"})}),Object(E.jsxs)(ee.default,{style:Ue.content,children:[Object(E.jsx)(w.default,{label:"Campaign Name",value:i,onChangeText:c,mode:"outlined",style:Ue.input}),Object(E.jsx)(w.default,{label:"Script",value:s,onChangeText:u,mode:"outlined",multiline:!0,numberOfLines:10,style:Ue.input}),Object(E.jsx)(S.default,{mode:"outlined",onPress:function(){return R(!0)},style:Ue.input,children:"Generate Script with AI"}),Object(E.jsxs)(S.default,{mode:"outlined",onPress:function(){return O(!0)},style:Ue.input,children:["Set Start Date: ",j.toLocaleDateString()]}),m&&Object(E.jsx)(Ce.default,{value:j,mode:"date",onChange:function(e,t){O(!1),t&&p(t)}}),k?Object(E.jsx)(re.default,{type:"error",children:k}):null,Object(E.jsx)(S.default,{mode:"contained",onPress:q,loading:P,disabled:P,style:Ue.submitButton,children:"Create Campaign"})]}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:M,onDismiss:function(){return R(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Generate Script"}),Object(E.jsx)(K.default.Content,{children:Object(E.jsx)(ze,{onGenerate:function(e){u(e),R(!1)},onCancel:function(){return R(!1)}})})]})})]})},Ue=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},content:{flex:1,padding:16},input:{marginBottom:16},submitButton:{marginTop:8,marginBottom:24}});function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ke={getVersions:function(){var e=g()((function*(e){var t=yield D.from("script_versions").select("*").eq("campaign_id",e).order("version_number",{ascending:!1}),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),createVersion:function(){var e=g()((function*(e){var t=yield D.from("script_versions").select("version_number").eq("campaign_id",e.campaign_id).order("version_number",{ascending:!1}).limit(1).single(),n=t.data,r=(t.error,((null==n?void 0:n.version_number)||0)+1),a=yield D.from("script_versions").insert([Je(Je({},e),{},{version_number:r})]).select().single(),i=a.data,c=a.error;if(c)throw c;return i}));return function(t){return e.apply(this,arguments)}}(),setActiveVersion:function(){var e=g()((function*(e,t){yield D.from("script_versions").update({is_active:!1}).eq("campaign_id",e);var n=yield D.from("script_versions").update({is_active:!0}).eq("id",t).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),compareVersions:function(){var e=g()((function*(e,t){var n=yield D.from("script_versions").select("*").in("id",[e,t]),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}()};function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xe=function(e){var t=e.campaignId,n=e.onSelectVersion,a=Object(r.useState)([]),i=y()(a,2),c=i[0],o=i[1],l=Object(r.useState)(!0),s=y()(l,2),u=(s[0],s[1]),d=Object(r.useState)(""),f=y()(d,2),j=(f[0],f[1]),p=Object(r.useState)([]),b=y()(p,2),h=b[0],m=b[1],O=Object(r.useState)(!1),x=y()(O,2),w=x[0],_=x[1],P=Object(r.useState)([]),D=y()(P,2),T=D[0],I=D[1];Object(r.useEffect)((function(){k()}),[t]);var k=function(){var e=g()((function*(){try{u(!0);var e=yield Ke.getVersions(t);o(e)}catch(n){j(n.message||"Failed to load versions")}finally{u(!1)}}));return function(){return e.apply(this,arguments)}}(),B=function(){var e=g()((function*(){if(2===h.length)try{u(!0);var e=yield Ke.compareVersions(h[0],h[1]);I(e),_(!0)}catch(t){j(t.message||"Failed to compare versions")}finally{u(!1)}}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=g()((function*(e){try{u(!0),yield Ke.setActiveVersion(t,e),yield k()}catch(n){j(n.message||"Failed to set active version")}finally{u(!1)}}));return function(t){return e.apply(this,arguments)}}();return Object(E.jsxs)(v.default,{style:Qe.container,children:[Object(E.jsxs)(v.default,{style:Qe.header,children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Version History"}),Object(E.jsx)(S.default,{mode:"outlined",onPress:B,disabled:2!==h.length,children:"Compare Selected"})]}),Object(E.jsx)(ee.default,{children:c.map((function(e){return Object(E.jsx)(Ae.List.Item,{title:"Version "+e.version_number,description:"Created: "+new Date(e.created_at).toLocaleDateString(),left:function(t){return Object(E.jsx)(Ae.List.Icon,Ze(Ze({},t),{},{icon:e.is_active?"check-circle":"file-document-outline"}))},right:function(t){return Object(E.jsxs)(v.default,{style:Qe.actionButtons,children:[Object(E.jsx)(te.default,{selected:h.includes(e.id),onPress:function(){return t=e.id,void(h.includes(t)?m(h.filter((function(e){return e!==t}))):h.length<2&&m([].concat(z()(h),[t])));var t},children:"Compare"}),!e.is_active&&Object(E.jsx)(S.default,{mode:"outlined",onPress:function(){return A(e.id)},children:"Set Active"})]})},onPress:function(){return n(e)}},e.id)}))}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:w,onDismiss:function(){return _(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Compare Versions"}),Object(E.jsx)(K.default.Content,{children:Object(E.jsx)(ee.default,{style:Qe.compareContent,children:T.map((function(e){return Object(E.jsxs)(v.default,{style:Qe.versionCompare,children:[Object(E.jsxs)(C.default,{variant:"titleSmall",children:["Version ",e.version_number]}),Object(E.jsx)(C.default,{children:e.content}),Object(E.jsxs)(C.default,{variant:"bodySmall",children:["Changes: ",e.changes]})]},e.id)}))})}),Object(E.jsx)(K.default.Actions,{children:Object(E.jsx)(S.default,{onPress:function(){return _(!1)},children:"Close"})})]})})]})},Qe=x.default.create({container:{flex:1},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,paddingHorizontal:16},actionButtons:{flexDirection:"row",alignItems:"center",gap:8},compareContent:{maxHeight:400},versionCompare:{marginBottom:16,padding:8,backgroundColor:"#f5f5f5",borderRadius:4}}),$e=n(222),et=[{label:"UTC",value:"UTC"},{label:"America/New_York (EST/EDT)",value:"America/New_York"},{label:"America/Chicago (CST/CDT)",value:"America/Chicago"},{label:"America/Denver (MST/MDT)",value:"America/Denver"},{label:"America/Los_Angeles (PST/PDT)",value:"America/Los_Angeles"},{label:"Europe/London (GMT/BST)",value:"Europe/London"},{label:"Europe/Paris (CET/CEST)",value:"Europe/Paris"},{label:"Asia/Tokyo (JST)",value:"Asia/Tokyo"},{label:"Asia/Shanghai (CST)",value:"Asia/Shanghai"},{label:"Australia/Sydney (AEST/AEDT)",value:"Australia/Sydney"}],tt=function(e){var t=e.value,n=e.onValueChange,a=r.useState(!1),i=y()(a,2),c=i[0],o=i[1],l=r.useState(""),s=y()(l,2),u=s[0],d=s[1],f=et.filter((function(e){return e.label.toLowerCase().includes(u.toLowerCase())})),j=et.find((function(e){return e.value===t}));return Object(E.jsxs)($e.default,{visible:c,onDismiss:function(){return o(!1)},anchor:Object(E.jsx)(w.default,{label:"Time Zone",value:(null==j?void 0:j.label)||t,onFocus:function(){return o(!0)},mode:"outlined",right:Object(E.jsx)(w.default.Icon,{icon:"menu-down"}),style:nt.input}),style:nt.menu,children:[Object(E.jsx)(w.default,{placeholder:"Search time zones...",value:u,onChangeText:d,mode:"outlined",style:nt.searchInput}),f.map((function(e){return Object(E.jsx)(Ae.List.Item,{title:e.label,onPress:function(){n(e.value),o(!1),d("")}},e.value)}))]})},nt=x.default.create({input:{marginBottom:12},menu:{maxHeight:400,width:"90%"},searchInput:{margin:8}}),rt=(x.default.create({container:{padding:16,alignItems:"center"},button:{marginTop:16}}),Array.from({length:24},(function(e,t){return t.toString().padStart(2,"0")}))),at=Array.from({length:12},(function(e,t){return(5*t).toString().padStart(2,"0")})),it=function(e){var t=e.value,n=e.onChange,a=e.label,i=r.useState(!1),c=y()(i,2),o=c[0],l=c[1],s=r.useState(t.split(":")[0]),u=y()(s,2),d=u[0],f=(u[1],r.useState(t.split(":")[1])),j=y()(f,2),p=j[0],b=(j[1],function(e,t){n(e+":"+t),l(!1)});return Object(E.jsxs)($e.default,{visible:o,onDismiss:function(){return l(!1)},anchor:Object(E.jsx)(w.default,{label:a,value:t,onFocus:function(){return l(!0)},mode:"outlined",right:Object(E.jsx)(w.default.Icon,{icon:"clock"}),style:ct.input}),style:ct.menu,children:[Object(E.jsx)($e.default.Item,{title:"Hours",style:ct.header,disabled:!0}),rt.map((function(e){return Object(E.jsx)($e.default.Item,{title:e,onPress:function(){return b(e,p)}},e)})),Object(E.jsx)($e.default.Item,{title:"Minutes",style:ct.header,disabled:!0}),at.map((function(e){return Object(E.jsx)($e.default.Item,{title:e,onPress:function(){return b(d,e)}},e)}))]})},ct=x.default.create({input:{flex:1},menu:{maxHeight:300},header:{backgroundColor:"#f5f5f5"}});function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var st=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}],ut=function(e){var t=e.campaignId,n=e.onSave,a=Object(r.useState)(null),i=y()(a,2),c=i[0],o=i[1],l=Object(r.useState)(!0),s=y()(l,2),u=s[0],d=s[1],f=Object(r.useState)(""),j=y()(f,2),p=j[0],b=j[1];Object(r.useEffect)((function(){h()}),[t]);var h=function(){var e=g()((function*(){try{d(!0);var e=yield me.getSchedule(t);o(e)}catch(n){b(n.message||"Failed to load schedule")}finally{d(!1)}}));return function(){return e.apply(this,arguments)}}(),m=function(){var e=g()((function*(){if(c)try{d(!0),yield me.updateSchedule(c.id,c),n()}catch(e){b(e.message||"Failed to save schedule")}finally{d(!1)}}));return function(){return e.apply(this,arguments)}}();return u?Object(E.jsx)(C.default,{children:"Loading schedule..."}):c?Object(E.jsxs)(v.default,{style:dt.container,children:[Object(E.jsx)(_e.default,{value:c.schedule_type,onValueChange:function(e){return o(lt(lt({},c),{},{schedule_type:e}))},buttons:[{value:"one_time",label:"One Time"},{value:"recurring",label:"Recurring"}],style:dt.segmentedButtons}),"recurring"===c.schedule_type&&Object(E.jsxs)(v.default,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",style:dt.sectionTitle,children:"Days of Week"}),Object(E.jsx)(v.default,{style:dt.daysContainer,children:st.map((function(e){var t;return Object(E.jsx)(te.default,{selected:null==(t=c.days_of_week)?void 0:t.includes(e.value),onPress:function(){var t=c.days_of_week||[],n=t.includes(e.value)?t.filter((function(t){return t!==e.value})):[].concat(z()(t),[e.value]).sort();o(lt(lt({},c),{},{days_of_week:n}))},style:dt.dayChip,children:e.label},e.value)}))})]}),Object(E.jsx)(C.default,{variant:"titleMedium",style:dt.sectionTitle,children:"Working Hours"}),Object(E.jsxs)(v.default,{style:dt.timeInputs,children:[Object(E.jsx)(it,{label:"Start Time",value:c.daily_start_time,onChange:function(e){return o(lt(lt({},c),{},{daily_start_time:e}))}}),Object(E.jsx)(it,{label:"End Time",value:c.daily_end_time,onChange:function(e){return o(lt(lt({},c),{},{daily_end_time:e}))}})]}),Object(E.jsx)(w.default,{label:"Max Concurrent Calls",value:c.max_concurrent_calls.toString(),onChangeText:function(e){return o(lt(lt({},c),{},{max_concurrent_calls:parseInt(e)||1}))},keyboardType:"numeric",mode:"outlined",style:dt.input}),p?Object(E.jsx)(re.default,{type:"error",children:p}):null,Object(E.jsx)(S.default,{mode:"contained",onPress:m,loading:u,disabled:u,style:dt.submitButton,children:"Save Schedule"})]}):Object(E.jsx)(C.default,{children:"No schedule found"})},dt=x.default.create({container:{flex:1,padding:16},segmentedButtons:{marginBottom:16},sectionTitle:{marginTop:16,marginBottom:8},input:{marginBottom:12},timeInputs:{flexDirection:"row",justifyContent:"space-between",gap:8},daysContainer:{flexDirection:"row",flexWrap:"wrap",marginBottom:16},dayChip:{margin:4},submitButton:{marginTop:16}});function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pt=function(e){var t=e.campaignId,n=e.onSave,a=Object(r.useState)(null),i=y()(a,2),c=i[0],o=i[1],l=Object(r.useState)(!0),s=y()(l,2),u=s[0],d=s[1],f=Object(r.useState)(""),j=y()(f,2),p=j[0],b=j[1],h=Object(r.useState)("general"),m=y()(h,2),O=m[0],x=m[1];Object(r.useEffect)((function(){_()}),[t]);var _=function(){var e=g()((function*(){try{d(!0);var e=yield pe.getSettings(t);o(e)}catch(n){b(n.message||"Failed to load settings")}finally{d(!1)}}));return function(){return e.apply(this,arguments)}}(),P=function(){var e=g()((function*(){if(c)try{d(!0),yield pe.updateSettings(t,c),n()}catch(e){b(e.message||"Failed to save settings")}finally{d(!1)}}));return function(){return e.apply(this,arguments)}}();return u?Object(E.jsx)(C.default,{children:"Loading settings..."}):c?Object(E.jsxs)(ee.default,{style:bt.container,children:[Object(E.jsx)(_e.default,{value:O,onValueChange:function(e){return x(e)},buttons:[{value:"general",label:"General"},{value:"voice",label:"Voice"},{value:"schedule",label:"Schedule"}],style:bt.segmentedButtons}),"general"===O&&Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",style:bt.sectionTitle,children:"Call Limits"}),Object(E.jsx)(w.default,{label:"Max Calls Per Day",value:c.max_calls_per_day.toString(),onChangeText:function(e){return o(jt(jt({},c),{},{max_calls_per_day:parseInt(e)||0}))},mode:"outlined",keyboardType:"numeric",style:bt.input}),Object(E.jsx)(C.default,{variant:"titleMedium",style:bt.sectionTitle,children:"Working Hours"}),Object(E.jsx)(tt,{value:c.time_zone,onValueChange:function(e){return o(jt(jt({},c),{},{time_zone:e}))}}),Object(E.jsxs)(v.default,{style:bt.timeInputs,children:[Object(E.jsx)(w.default,{label:"Start Time",value:c.working_hours.start,onChangeText:function(e){return o(jt(jt({},c),{},{working_hours:jt(jt({},c.working_hours),{},{start:e})}))},mode:"outlined",style:[bt.input,bt.timeInput]}),Object(E.jsx)(w.default,{label:"End Time",value:c.working_hours.end,onChangeText:function(e){return o(jt(jt({},c),{},{working_hours:jt(jt({},c.working_hours),{},{end:e})}))},mode:"outlined",style:[bt.input,bt.timeInput]})]}),Object(E.jsx)(C.default,{variant:"titleMedium",style:bt.sectionTitle,children:"Call Handling"}),Object(E.jsx)(w.default,{label:"Max Retries",value:c.call_handling.max_retries.toString(),onChangeText:function(e){return o(jt(jt({},c),{},{call_handling:jt(jt({},c.call_handling),{},{max_retries:parseInt(e)||0})}))},mode:"outlined",keyboardType:"numeric",style:bt.input}),Object(E.jsx)(w.default,{label:"Retry Interval (minutes)",value:c.call_handling.retry_interval.toString(),onChangeText:function(e){return o(jt(jt({},c),{},{call_handling:jt(jt({},c.call_handling),{},{retry_interval:parseInt(e)||30})}))},mode:"outlined",keyboardType:"numeric",style:bt.input}),Object(E.jsx)(_e.default,{value:c.call_handling.voicemail_behavior,onValueChange:function(e){return o(jt(jt({},c),{},{call_handling:jt(jt({},c.call_handling),{},{voicemail_behavior:e})}))},buttons:[{value:"leave_message",label:"Leave Message"},{value:"skip",label:"Skip"},{value:"mark_failed",label:"Mark Failed"}],style:bt.segmentedButtons}),Object(E.jsxs)(v.default,{style:bt.switchContainer,children:[Object(E.jsx)(C.default,{children:"Enable Call Recording"}),Object(E.jsx)(ne.default,{value:c.call_handling.recording_enabled,onValueChange:function(e){return o(jt(jt({},c),{},{call_handling:jt(jt({},c.call_handling),{},{recording_enabled:e})}))}})]})]}),"voice"===O&&Object(E.jsx)(void 0,{selectedVoiceId:c.voice_settings.voice_id,onVoiceSelect:function(e){return o(jt(jt({},c),{},{voice_settings:jt(jt({},c.voice_settings),{},{voice_id:e})}))}}),"schedule"===O&&Object(E.jsx)(ut,{campaignId:t,onSave:function(){_()}}),p?Object(E.jsx)(re.default,{type:"error",children:p}):null,Object(E.jsx)(S.default,{mode:"contained",onPress:P,loading:u,disabled:u,style:bt.submitButton,children:"Save Settings"})]}):Object(E.jsx)(C.default,{children:"No settings found"})},bt=x.default.create({container:{flex:1,padding:16},sectionTitle:{marginTop:16,marginBottom:8},input:{marginBottom:12},timeInputs:{flexDirection:"row",justifyContent:"space-between"},timeInput:{flex:1,marginHorizontal:4},segmentedButtons:{marginVertical:12},switchContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginVertical:12},submitButton:{marginTop:16,marginBottom:24}}),ht=function(e){var t=e.navigation,n=e.route.params.id,a=q().user,i=Object(r.useState)(null),c=y()(i,2),o=c[0],l=c[1],s=Object(r.useState)(""),u=y()(s,2),d=u[0],f=u[1],j=Object(r.useState)(""),p=y()(j,2),b=p[0],h=p[1],m=Object(r.useState)(new Date),O=y()(m,2),x=O[0],_=O[1],P=Object(r.useState)(!1),D=y()(P,2),T=D[0],I=D[1],k=Object(r.useState)(!1),B=y()(k,2),A=B[0],L=B[1],M=Object(r.useState)(""),R=y()(M,2),F=R[0],N=R[1],V=Object(r.useState)(!1),z=y()(V,2),H=z[0],G=z[1],U=Object(r.useState)(!1),W=y()(U,2),Y=W[0],Z=W[1],X=Object(r.useState)(null),Q=y()(X,2),$=Q[0],te=Q[1],ne=Object(r.useState)("script"),ae=y()(ne,2),ie=ae[0],ce=ae[1];Object(r.useEffect)((function(){oe()}),[n]);var oe=function(){var e=g()((function*(){try{L(!0);var e=yield ye.getCampaign(n);l(e),f(e.name),h(e.script),_(new Date(e.start_date));var t=(yield Ke.getVersions(n)).find((function(e){return e.is_active}));t&&(te(t),h(t.content))}catch(r){N(r.message||"Error loading campaign")}finally{L(!1)}}));return function(){return e.apply(this,arguments)}}(),le=function(){var e=g()((function*(){if(d&&b)try{L(!0),N("");var e={name:d,script:b,start_date:x.toISOString()};yield ye.updateCampaign(n,e),b!==(null==$?void 0:$.content)&&(yield Ke.createVersion({campaign_id:n,content:b,metadata:(null==$?void 0:$.metadata)||{industry:"",product:"",targetAudience:""},changes:"Manual script update",created_by:(null==a?void 0:a.id)||"",is_active:!0})),t.goBack()}catch(r){N(r.message||"An error occurred")}finally{L(!1)}else N("Please fill in all required fields")}));return function(){return e.apply(this,arguments)}}();return o||F?Object(E.jsxs)(v.default,{style:mt.container,children:[Object(E.jsxs)(v.default,{style:mt.header,children:[Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Edit Campaign"}),Object(E.jsx)(S.default,{mode:"contained",onPress:function(){return t.goBack()},children:"Cancel"})]}),Object(E.jsx)(_e.default,{value:ie,onValueChange:function(e){return ce(e)},buttons:[{value:"script",label:"Script"},{value:"settings",label:"Settings"}],style:mt.tabs}),"script"===ie?Object(E.jsxs)(ee.default,{style:mt.content,children:[Object(E.jsx)(w.default,{label:"Campaign Name",value:d,onChangeText:f,mode:"outlined",style:mt.input}),Object(E.jsxs)(v.default,{style:mt.scriptHeader,children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Script"}),Object(E.jsxs)(v.default,{style:mt.scriptActions,children:[Object(E.jsx)(S.default,{mode:"outlined",onPress:function(){return Z(!0)},style:mt.actionButton,children:"Version History"}),Object(E.jsx)(S.default,{mode:"outlined",onPress:function(){return G(!0)},style:mt.actionButton,children:"Generate with AI"})]})]}),Object(E.jsx)(w.default,{value:b,onChangeText:h,mode:"outlined",multiline:!0,numberOfLines:10,style:mt.scriptInput}),Object(E.jsxs)(S.default,{mode:"outlined",onPress:function(){return I(!0)},style:mt.input,children:["Start Date: ",x.toLocaleDateString()]}),T&&Object(E.jsx)(Ce.default,{value:x,mode:"date",onChange:function(e,t){I(!1),t&&_(t)}}),F?Object(E.jsx)(re.default,{type:"error",children:F}):null,Object(E.jsx)(S.default,{mode:"contained",onPress:le,loading:A,disabled:A,style:mt.submitButton,children:"Update Campaign"})]}):Object(E.jsx)(pt,{campaignId:n,onSave:function(){oe()}}),Object(E.jsxs)(J.default,{children:[Object(E.jsxs)(K.default,{visible:H,onDismiss:function(){return G(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Generate Script"}),Object(E.jsx)(K.default.Content,{children:Object(E.jsx)(ze,{onGenerate:function(e){h(e),G(!1)},onCancel:function(){return G(!1)}})})]}),Object(E.jsxs)(K.default,{visible:Y,onDismiss:function(){return Z(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Script Versions"}),Object(E.jsx)(K.default.Content,{children:Object(E.jsx)(Xe,{campaignId:n,onSelectVersion:function(e){h(e.content),te(e),Z(!1)}})})]})]})]}):Object(E.jsx)(v.default,{style:[mt.container,mt.centered],children:Object(E.jsx)(C.default,{children:"Loading..."})})},mt=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{justifyContent:"center",alignItems:"center"},header:{padding:16,backgroundColor:"#fff",flexDirection:"row",justifyContent:"space-between",alignItems:"center",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:2},content:{flex:1,padding:16},input:{marginBottom:16},scriptHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},scriptActions:{flexDirection:"row"},actionButton:{marginLeft:8},scriptInput:{marginBottom:16,minHeight:200},submitButton:{marginTop:8,marginBottom:24},tabs:{margin:16}});function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yt=function(e){var t=e.navigation,n=r.useState([]),a=y()(n,2),i=a[0],c=a[1],o=r.useState(!0),l=y()(o,2),s=l[0],u=l[1],d=r.useState(!1),f=y()(d,2),j=f[0],p=f[1],b=r.useState(""),h=y()(b,2),m=h[0],O=h[1],x=r.useState(""),_=y()(x,2),P=_[0],D=_[1];r.useEffect((function(){T()}),[]);var T=function(){var e=g()((function*(){try{u(!0);var e=yield $.getLists();c(e)}catch(t){console.error("Error loading lists:",t)}finally{u(!1)}}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=g()((function*(){try{var e=yield $.createList({name:m,description:P,user_id:""});c([e].concat(z()(i))),p(!1),O(""),D("")}catch(t){console.error("Error creating list:",t)}}));return function(){return e.apply(this,arguments)}}(),k=function(){var e=g()((function*(e){try{yield $.deleteList(e),c(i.filter((function(t){return t.id!==e})))}catch(t){console.error("Error deleting list:",t)}}));return function(t){return e.apply(this,arguments)}}();return Object(E.jsxs)(v.default,{style:vt.container,children:[Object(E.jsx)(v.default,{style:vt.header,children:Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Contact Lists"})}),Object(E.jsx)(H.default,{data:i,renderItem:function(e){var n=e.item;return Object(E.jsxs)(L.default,{style:vt.card,onPress:function(){return t.navigate("ContactListDetail",{id:n.id})},children:[Object(E.jsx)(L.default.Title,{title:n.name,subtitle:n.contact_count+" contacts",right:function(e){return Object(E.jsx)(G.default,Ot(Ot({},e),{},{icon:"delete",onPress:function(){return k(n.id)}}))}}),n.description&&Object(E.jsx)(L.default.Content,{children:Object(E.jsx)(C.default,{children:n.description})})]})},keyExtractor:function(e){return e.id},contentContainerStyle:vt.list,refreshing:s,onRefresh:T}),Object(E.jsx)(W.default,{icon:"plus",style:vt.fab,onPress:function(){return p(!0)}}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:j,onDismiss:function(){return p(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Create New List"}),Object(E.jsxs)(K.default.Content,{children:[Object(E.jsx)(w.default,{label:"List Name",value:m,onChangeText:O,style:vt.input}),Object(E.jsx)(w.default,{label:"Description (optional)",value:P,onChangeText:D,multiline:!0,style:vt.input})]}),Object(E.jsxs)(K.default.Actions,{children:[Object(E.jsx)(S.default,{onPress:function(){return p(!1)},children:"Cancel"}),Object(E.jsx)(S.default,{onPress:I,disabled:!m.trim(),children:"Create"})]})]})})]})},vt=x.default.create({container:{flex:1},header:{padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},list:{padding:16},card:{marginBottom:16},input:{marginBottom:16},fab:{position:"absolute",margin:16,right:0,bottom:0}}),xt=n(543);function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var St=function(e){var t=e.visible,n=e.onDismiss,a=e.listId,i=e.listName,c=r.useState(""),o=y()(c,2),l=o[0],s=o[1],u=r.useState("read"),d=y()(u,2),f=d[0],j=d[1],p=r.useState([]),b=y()(p,2),h=b[0],m=b[1],O=r.useState(!1),x=y()(O,2),_=x[0],P=x[1],D=r.useState(""),T=y()(D,2),I=T[0],k=T[1];r.useEffect((function(){t&&B()}),[t]);var B=function(){var e=g()((function*(){try{P(!0);var e=yield $.getSharedLists();m(e.filter((function(e){return e.list_id===a})))}catch(t){k(t.message)}finally{P(!1)}}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=g()((function*(){try{P(!0),k(""),yield $.shareList(a,l,f),yield B(),s("")}catch(e){k(e.message)}finally{P(!1)}}));return function(){return e.apply(this,arguments)}}(),L=function(){var e=g()((function*(e){try{P(!0),yield $.removeSharing(e),yield B()}catch(t){k(t.message)}finally{P(!1)}}));return function(t){return e.apply(this,arguments)}}();return Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:t,onDismiss:n,children:[Object(E.jsxs)(K.default.Title,{children:["Share List: ",i]}),Object(E.jsxs)(K.default.Content,{children:[Object(E.jsxs)(v.default,{style:_t.inputContainer,children:[Object(E.jsx)(w.default,{label:"Email",value:l,onChangeText:s,keyboardType:"email-address",style:_t.emailInput}),Object(E.jsxs)(v.default,{style:_t.permissionsContainer,children:[Object(E.jsx)(te.default,{selected:"read"===f,onPress:function(){return j("read")},style:_t.chip,children:"Read Only"}),Object(E.jsx)(te.default,{selected:"write"===f,onPress:function(){return j("write")},style:_t.chip,children:"Can Edit"})]}),Object(E.jsx)(S.default,{mode:"contained",onPress:A,loading:_,disabled:!l.trim()||_,children:"Share"})]}),I?Object(E.jsx)(C.default,{style:_t.error,children:I}):null,Object(E.jsx)(Ae.List.Section,{title:"Shared With",children:h.map((function(e){return Object(E.jsx)(Ae.List.Item,{title:e.shared_by.email,description:"read"===e.permissions?"Read Only":"Can Edit",right:function(t){return Object(E.jsx)(G.default,wt(wt({},t),{},{icon:"close",onPress:function(){return L(e.id)}}))}},e.id)}))})]}),Object(E.jsx)(K.default.Actions,{children:Object(E.jsx)(S.default,{onPress:n,children:"Done"})})]})})},_t=x.default.create({inputContainer:{marginBottom:16},emailInput:{marginBottom:8},permissionsContainer:{flexDirection:"row",marginBottom:16},chip:{marginRight:8},error:{color:"#dc3545",marginBottom:16}});function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tt=function(e){e.navigation;var t=e.route.params.id,n=r.useState([]),a=y()(n,2),i=a[0],c=a[1],o=r.useState([]),l=y()(o,2),s=l[0],u=l[1],d=r.useState(!0),f=y()(d,2),j=f[0],p=f[1],b=r.useState(!1),h=y()(b,2),m=h[0],O=h[1],x=r.useState(""),w=y()(x,2),_=w[0],P=w[1],D=r.useState([]),T=y()(D,2),I=T[0],k=T[1],B=r.useState(!1),A=y()(B,2),L=A[0],M=A[1],R=r.useState(null),q=y()(R,2),F=q[0],N=q[1];r.useEffect((function(){V()}),[t]);var V=function(){var e=g()((function*(){try{p(!0);var e=yield Promise.all([$.getLists().then((function(e){return e.find((function(e){return e.id===t}))})),$.getListContacts(t),$.getContacts()]),n=y()(e,3),r=n[0],a=n[1],i=n[2];N(r||null),c(a),u(i)}catch(o){console.error("Error loading contacts:",o)}finally{p(!1)}}));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=g()((function*(){try{yield $.addContactsToList(t,I),yield V(),O(!1),k([])}catch(e){console.error("Error adding contacts:",e)}}));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=g()((function*(e){try{yield $.removeContactsFromList(t,[e]),c(i.filter((function(t){return t.id!==e})))}catch(n){console.error("Error removing contact:",n)}}));return function(t){return e.apply(this,arguments)}}(),X=s.filter((function(e){return!i.find((function(t){return t.id===e.id}))&&(e.first_name+" "+e.last_name).toLowerCase().includes(_.toLowerCase())}));return Object(E.jsxs)(v.default,{style:Et.container,children:[Object(E.jsxs)(v.default,{style:Et.header,children:[Object(E.jsx)(C.default,{variant:"headlineMedium",children:null==F?void 0:F.name}),Object(E.jsx)(S.default,{mode:"contained",onPress:function(){return M(!0)},icon:"share",children:"Share"})]}),Object(E.jsx)(H.default,{data:i,renderItem:function(e){var t=e.item;return Object(E.jsx)(Ae.List.Item,{title:t.first_name+" "+t.last_name,description:t.phone_number,right:function(e){return Object(E.jsx)(G.default,Dt(Dt({},e),{},{icon:"close",onPress:function(){return Z(t.id)}}))}})},keyExtractor:function(e){return e.id},refreshing:j,onRefresh:V}),Object(E.jsx)(W.default,{icon:"plus",style:Et.fab,onPress:function(){return O(!0)}}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:m,onDismiss:function(){return O(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Add Contacts"}),Object(E.jsxs)(K.default.Content,{children:[Object(E.jsx)(U.default,{placeholder:"Search contacts",onChangeText:P,value:_,style:Et.searchbar}),Object(E.jsx)(H.default,{data:X,renderItem:function(e){var t=e.item;return Object(E.jsx)(Ae.List.Item,{title:t.first_name+" "+t.last_name,description:t.phone_number,right:function(e){return Object(E.jsx)(xt.default,{status:I.includes(t.id)?"checked":"unchecked",onPress:function(){k((function(e){return e.includes(t.id)?e.filter((function(e){return e!==t.id})):[].concat(z()(e),[t.id])}))}})}})},keyExtractor:function(e){return e.id},style:Et.contactList})]}),Object(E.jsxs)(K.default.Actions,{children:[Object(E.jsx)(S.default,{onPress:function(){return O(!1)},children:"Cancel"}),Object(E.jsx)(S.default,{onPress:Y,disabled:0===I.length,children:"Add Selected"})]})]})}),F&&Object(E.jsx)(St,{visible:L,onDismiss:function(){return M(!1)},listId:F.id,listName:F.name})]})},Et=x.default.create({container:{flex:1},searchbar:{marginBottom:16},contactList:{maxHeight:400},fab:{position:"absolute",margin:16,right:0,bottom:0},header:{flexDirection:"row",alignItems:"center",padding:16}}),It=n(117),kt={getContactStats:function(){var e=g()((function*(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1).toISOString(),n=yield D.from("contacts").select("*"),r=n.data,a=n.error;if(a)throw a;var i=r;return{totalContacts:i.length,newContactsThisMonth:i.filter((function(e){return e.created_at>=t})).length,contactsByCompany:Object.entries(i.reduce((function(e,t){var n=t.company||"No Company";return e[n]=(e[n]||0)+1,e}),{})).map((function(e){var t=y()(e,2);return{company:t[0],count:t[1]}})).sort((function(e,t){return t.count-e.count})).slice(0,5),contactsByTag:Object.entries(i.reduce((function(e,t){return t.tags.forEach((function(t){e[t]=(e[t]||0)+1})),e}),{})).map((function(e){var t=y()(e,2);return{tag:t[0],count:t[1]}})).sort((function(e,t){return t.count-e.count})).slice(0,10),doNotCallCount:i.filter((function(e){return e.do_not_call})).length}}));return function(){return e.apply(this,arguments)}}()},Bt=function(){var e=r.useState(null),t=y()(e,2),n=t[0],a=t[1],i=r.useState(!0),c=y()(i,2),o=c[0],l=c[1],s=r.useState(""),u=y()(s,2),d=u[0],f=u[1];r.useEffect((function(){j()}),[]);var j=function(){var e=g()((function*(){try{l(!0);var e=yield kt.getContactStats();a(e)}catch(t){f(t.message||"Failed to load statistics")}finally{l(!1)}}));return function(){return e.apply(this,arguments)}}();return o?Object(E.jsx)(v.default,{style:At.centered,children:Object(E.jsx)(It.default,{size:"large"})}):d?Object(E.jsx)(v.default,{style:At.centered,children:Object(E.jsx)(C.default,{style:At.error,children:d})}):n?Object(E.jsxs)(ee.default,{style:At.container,children:[Object(E.jsxs)(v.default,{style:At.row,children:[Object(E.jsx)(L.default,{style:[At.card,At.halfCard],children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Total Contacts"}),Object(E.jsx)(C.default,{variant:"displaySmall",children:n.totalContacts})]})}),Object(E.jsx)(L.default,{style:[At.card,At.halfCard],children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"New This Month"}),Object(E.jsx)(C.default,{variant:"displaySmall",children:n.newContactsThisMonth})]})})]}),Object(E.jsx)(L.default,{style:At.card,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Top Companies"}),n.contactsByCompany.map((function(e){var t=e.company,n=e.count;return Object(E.jsx)(Ae.List.Item,{title:t,right:function(){return Object(E.jsxs)(C.default,{children:[n," contacts"]})}},t)}))]})}),Object(E.jsx)(L.default,{style:At.card,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Popular Tags"}),Object(E.jsx)(v.default,{style:At.tags,children:n.contactsByTag.map((function(e){var t=e.tag,n=e.count;return Object(E.jsxs)(te.default,{style:At.tag,children:[t," (",n,")"]},t)}))})]})}),Object(E.jsx)(L.default,{style:At.card,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Do Not Call"}),Object(E.jsx)(C.default,{variant:"displaySmall",children:n.doNotCallCount}),Object(E.jsx)(C.default,{variant:"bodyMedium",children:"contacts marked as do not call"})]})})]}):null},At=x.default.create({container:{flex:1,padding:16},centered:{flex:1,justifyContent:"center",alignItems:"center"},row:{flexDirection:"row",gap:16,marginBottom:16},card:{marginBottom:16},halfCard:{flex:1},tags:{flexDirection:"row",flexWrap:"wrap",marginTop:8},tag:{margin:4},error:{color:"#dc3545"}}),Lt=function(){return Object(E.jsxs)(v.default,{style:Mt.container,children:[Object(E.jsx)(v.default,{style:Mt.header,children:Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Contact Analytics"})}),Object(E.jsx)(Bt,{})]})},Mt=x.default.create({container:{flex:1},header:{padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"}}),Rt=n(1047),qt=n(1048),Ft=function(e){var t=e.length,n=e.filter((function(e){return"completed"===e.status})).length,r=e.reduce((function(e,t){return e+(t.duration||0)}),0),a=e.reduce((function(e,t){return e[t.status]=(e[t.status]||0)+1,e}),{}),i=e.reduce((function(e,t){var n=new Date(t.created_at).toLocaleDateString(),r=e.find((function(e){return e.date===n}));return r?r.count++:e.push({date:n,count:1}),e}),[]),c=e.reduce((function(e,t){var n=new Date(t.created_at).getHours(),r=e.find((function(e){return e.hour===n}));return r?r.count++:e.push({hour:n,count:1}),e}),[]).sort((function(e,t){return e.hour-t.hour}));return{totalCalls:t,successRate:t?Math.round(n/t*100):0,avgDuration:t?Math.round(r/t):0,statusBreakdown:a,callsByDay:i,callsByHour:c}},Nt=function(e){var t=e.route.params.id,n=a.a.useState(null),i=y()(n,2),c=i[0],o=i[1],l=a.a.useState(!0),s=y()(l,2),u=s[0],d=s[1],f=Object(r.useState)(""),j=y()(f,2),p=j[0],b=j[1];a.a.useEffect((function(){h()}),[t]);var h=function(){var e=g()((function*(){try{d(!0),b("");var e=yield ye.getAnalytics(t);o(Ft(e))}catch(p){console.error("Error loading analytics:",p),b(p.message||"Failed to load analytics")}finally{d(!1)}}));return function(){return e.apply(this,arguments)}}();return u?Object(E.jsx)(v.default,{style:Vt.centered,children:Object(E.jsx)(It.default,{size:"large"})}):p?Object(E.jsxs)(v.default,{style:Vt.centered,children:[Object(E.jsx)(C.default,{style:Vt.error,children:p}),Object(E.jsx)(S.default,{mode:"contained",onPress:h,style:Vt.retryButton,children:"Retry"})]}):Object(E.jsxs)(ee.default,{style:Vt.container,children:[Object(E.jsx)(v.default,{style:Vt.header,children:Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Campaign Analytics"})}),Object(E.jsxs)(v.default,{style:Vt.statsGrid,children:[Object(E.jsx)(L.default,{style:Vt.statCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Total Calls"}),Object(E.jsx)(C.default,{variant:"displaySmall",children:c.totalCalls})]})}),Object(E.jsx)(L.default,{style:Vt.statCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Success Rate"}),Object(E.jsxs)(C.default,{variant:"displaySmall",children:[c.successRate,"%"]})]})}),Object(E.jsx)(L.default,{style:Vt.statCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Avg Duration"}),Object(E.jsxs)(C.default,{variant:"displaySmall",children:[c.avgDuration,"s"]})]})})]}),Object(E.jsx)(L.default,{style:Vt.chartCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Calls by Day"}),Object(E.jsx)(Rt.ResponsiveContainer,{width:"100%",height:300,children:Object(E.jsx)(qt.LineChart,{data:c.callsByDay,margin:{top:5,right:30,left:20,bottom:5}})})]})}),Object(E.jsx)(L.default,{style:Vt.chartCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Calls by Hour"}),Object(E.jsx)(Rt.ResponsiveContainer,{width:"100%",height:300,children:Object(E.jsx)(qt.LineChart,{data:c.callsByHour,margin:{top:5,right:30,left:20,bottom:5}})})]})})]})},Vt=x.default.create({container:{flex:1},header:{padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},centered:{flex:1,justifyContent:"center",alignItems:"center"},statsGrid:{flexDirection:"row",flexWrap:"wrap",padding:8},statCard:{flex:1,margin:8,minWidth:150},chartCard:{margin:16},error:{color:"#dc3545",marginBottom:16},retryButton:{minWidth:120}}),zt=function(e){var t=e.route,n=e.navigation,a=t.params.id,i=r.useState("general"),c=y()(i,2),o=c[0],l=c[1];return Object(E.jsxs)(v.default,{style:Ht.container,children:[Object(E.jsx)(v.default,{style:Ht.header,children:Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Campaign Settings"})}),Object(E.jsx)(_e.default,{value:o,onValueChange:function(e){return l(e)},buttons:[{value:"general",label:"General"},{value:"voice",label:"Voice"},{value:"schedule",label:"Schedule"}],style:Ht.segmentedButtons}),Object(E.jsxs)(ee.default,{style:Ht.content,children:["general"===o&&Object(E.jsx)(pt,{campaignId:a,onSave:function(){return n.goBack()}}),"voice"===o&&Object(E.jsx)(void 0,{campaignId:a,onSave:function(){return n.goBack()}}),"schedule"===o&&Object(E.jsx)(ut,{campaignId:a,onSave:function(){return n.goBack()}})]})]})},Ht=x.default.create({container:{flex:1},header:{padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},segmentedButtons:{margin:16},content:{flex:1}}),Gt=n(542),Ut={getCallHistory:function(){var e=g()((function*(e){var t,n=D.from("call_records").select("\n        *,\n        contacts (\n          first_name,\n          last_name,\n          phone_number,\n          company\n        )\n      ").order("start_time",{ascending:!1});e.campaignId&&(n=n.eq("campaign_id",e.campaignId)),null!=(t=e.status)&&t.length&&(n=n.in("status",e.status)),e.dateRange&&(n=n.gte("start_time",e.dateRange.start).lte("start_time",e.dateRange.end));var r=yield n,a=r.data,i=r.error;if(i)throw i;return a}));return function(t){return e.apply(this,arguments)}}(),exportCallHistory:function(){var e=g()((function*(e){return(yield Ut.getCallHistory(e)).map((function(e){return{date:new Date(e.start_time).toLocaleDateString(),time:new Date(e.start_time).toLocaleTimeString(),contact_name:e.contact.first_name+" "+e.contact.last_name,phone:e.contact.phone_number,company:e.contact.company||"",status:e.status,duration:e.duration+"s",notes:e.notes||""}}))}));return function(t){return e.apply(this,arguments)}}(),getCallDetails:function(){var e=g()((function*(e){var t=yield D.from("call_records").select("\n        *,\n        contacts (\n          first_name,\n          last_name,\n          phone_number,\n          company\n        )\n      ").eq("id",e).single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),updateCallNotes:function(){var e=g()((function*(e,t){var n=(yield D.from("call_records").update({notes:t}).eq("id",e)).error;if(n)throw n}));return function(t,n){return e.apply(this,arguments)}}()},Wt=n(1058),Jt=n(639),Kt=n(375),Yt=n(370),Zt=n.n(Yt);function Xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $t=Y.z.object({first_name:Y.z.string().min(1,"First name is required"),last_name:Y.z.string().min(1,"Last name is required"),phone_number:Y.z.string().min(10,"Phone number must be at least 10 digits").regex(/^\+?[\d\s-()]+$/,"Invalid phone number format"),email:Y.z.string().email("Invalid email format").optional().nullable(),company:Y.z.string().optional().nullable(),job_title:Y.z.string().optional().nullable(),tags:Y.z.array(Y.z.string()),notes:Y.z.string().optional().nullable(),do_not_call:Y.z.boolean()}),en={importContacts:function(){var e=g()((function*(){try{var e=yield Jt.getDocumentAsync({type:"text/csv",copyToCacheDirectory:!0});if("success"===e.type){var t=yield Wt.readAsStringAsync(e.uri),n=Zt.a.parse(t,{header:!0}).data.map((function(e){return{first_name:e.first_name||"",last_name:e.last_name||"",phone_number:e.phone_number||"",email:e.email||null,company:e.company||null,job_title:e.job_title||null,tags:e.tags?e.tags.split(",").map((function(e){return e.trim()})):[],notes:e.notes||null,do_not_call:"true"===e.do_not_call}})),r=function(e){var t=[];return e.forEach((function(e,n){try{var r=Qt(Qt({},e),{},{tags:Array.isArray(e.tags)?e.tags:[],do_not_call:Boolean(e.do_not_call)});$t.parse(r)}catch(i){if(i instanceof Y.z.ZodError){var a={};i.errors.forEach((function(e){var t=e.path.join(".");a[t]=e.message})),t.push({row:n+1,errors:a})}}})),t}(n);if(r.length>0)throw{type:"ValidationError",errors:r};return n}return null}catch(a){throw console.error("Error importing contacts:",a),a}}));return function(){return e.apply(this,arguments)}}(),exportContacts:function(){var e=g()((function*(e){try{var t=e.map((function(e){return{first_name:e.first_name,last_name:e.last_name,phone_number:e.phone_number,email:e.email||"",company:e.company||"",job_title:e.job_title||"",tags:e.tags.join(","),notes:e.notes||"",do_not_call:e.do_not_call.toString()}})),n=Zt.a.unparse(t),r="contacts_"+(new Date).toISOString().split("T")[0]+".csv",a=""+Wt.cacheDirectory+r;yield Wt.writeAsStringAsync(a,n),(yield Kt.isAvailableAsync())&&(yield Kt.shareAsync(a))}catch(i){throw console.error("Error exporting contacts:",i),i}}));return function(t){return e.apply(this,arguments)}}(),exportToCSV:function(){var e=g()((function*(e,t){var n=tn(e),r=new Blob([n],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(r),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download",t),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}));return function(t,n){return e.apply(this,arguments)}}(),exportToExcel:function(){var e=g()((function*(e,t){}));return function(t,n){return e.apply(this,arguments)}}()},tn=function(e){var t=Object.keys(e[0]),n=e.map((function(e){return t.map((function(t){return JSON.stringify(e[t])})).join(",")}));return[t.join(",")].concat(z()(n)).join("\n")};function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var an=[{label:"Completed",value:"completed"},{label:"Failed",value:"failed"},{label:"No Answer",value:"no-answer"},{label:"Voicemail",value:"voicemail"}],cn=function(e){var t,n,a,i,c=e.route.params.campaignId,o=Object(r.useState)([]),l=y()(o,2),u=l[0],d=l[1],f=Object(r.useState)(!0),j=y()(f,2),p=j[0],b=j[1],h=Object(r.useState)({campaignId:c,status:[],dateRange:{start:new Date(Date.now()-6048e5).toISOString(),end:(new Date).toISOString()}}),m=y()(h,2),O=m[0],x=m[1],_=Object(r.useState)(null),P=y()(_,2),D=P[0],T=P[1],I=Object(r.useState)(null),k=y()(I,2),B=k[0],A=k[1],L=Object(r.useState)(""),M=y()(L,2),R=M[0],q=M[1];Object(r.useEffect)((function(){F()}),[O]);var F=function(){var e=g()((function*(){try{b(!0);var e=yield Ut.getCallHistory(O);d(e)}catch(t){console.error("Error loading calls:",t)}finally{b(!1)}}));return function(){return e.apply(this,arguments)}}(),N=function(){var e=g()((function*(){try{b(!0);var e=yield Ut.exportCallHistory(O);yield en.exportToCSV(e,"call_history.csv")}catch(t){console.error("Error exporting calls:",t)}finally{b(!1)}}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=g()((function*(){if(B)try{yield Ut.updateCallNotes(B.id,R),A(null),q(""),F()}catch(e){console.error("Error updating notes:",e)}}));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(v.default,{style:on.container,children:[Object(E.jsxs)(v.default,{style:on.header,children:[Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Call History"}),Object(E.jsx)(S.default,{mode:"contained",onPress:N,loading:p,disabled:p,children:"Export"})]}),Object(E.jsxs)(v.default,{style:on.filters,children:[Object(E.jsxs)(v.default,{style:on.dateFilters,children:[Object(E.jsxs)(S.default,{mode:"outlined",onPress:function(){return T("start")},children:["From: ",new Date((null==(t=O.dateRange)?void 0:t.start)||"").toLocaleDateString()]}),Object(E.jsxs)(S.default,{mode:"outlined",onPress:function(){return T("end")},children:["To: ",new Date((null==(n=O.dateRange)?void 0:n.end)||"").toLocaleDateString()]})]}),Object(E.jsx)(ee.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,children:Object(E.jsx)(v.default,{style:on.statusChips,children:an.map((function(e){var t,n=e.label,r=e.value;return Object(E.jsx)(te.default,{selected:null==(t=O.status)?void 0:t.includes(r),onPress:function(){return e=r,void x((function(t){var n;return rn(rn({},t),{},{status:null!=(n=t.status)&&n.includes(e)?t.status.filter((function(t){return t!==e})):[].concat(z()(t.status||[]),[e])})}));var e},style:on.chip,children:n},r)}))})})]}),Object(E.jsxs)(Gt.default,{children:[Object(E.jsxs)(Gt.default.Header,{children:[Object(E.jsx)(Gt.default.Title,{children:"Contact"}),Object(E.jsx)(Gt.default.Title,{children:"Status"}),Object(E.jsx)(Gt.default.Title,{numeric:!0,children:"Duration"}),Object(E.jsx)(Gt.default.Title,{children:"Notes"})]}),Object(E.jsx)(ee.default,{children:u.map((function(e){return Object(E.jsxs)(Gt.default.Row,{onPress:function(){A(e),q(e.notes||"")},children:[Object(E.jsxs)(Gt.default.Cell,{children:[e.contact.first_name," ",e.contact.last_name]}),Object(E.jsx)(Gt.default.Cell,{children:e.status}),Object(E.jsxs)(Gt.default.Cell,{numeric:!0,children:[e.duration,"s"]}),Object(E.jsx)(Gt.default.Cell,{children:e.notes?"Yes":"No"})]},e.id)}))})]}),D&&Object(E.jsx)(Ce.default,{value:new Date("start"===D?(null==(a=O.dateRange)?void 0:a.start)||"":(null==(i=O.dateRange)?void 0:i.end)||""),mode:"date",onChange:function(e,t){T(null),t&&x((function(e){return rn(rn({},e),{},{dateRange:rn(rn({},e.dateRange),{},s()({},D,t.toISOString()))})}))}}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:!!B,onDismiss:function(){return A(null)},children:[Object(E.jsx)(K.default.Title,{children:"Call Notes"}),Object(E.jsx)(K.default.Content,{children:Object(E.jsx)(w.default,{label:"Notes",value:R,onChangeText:q,multiline:!0,numberOfLines:4,mode:"outlined"})}),Object(E.jsxs)(K.default.Actions,{children:[Object(E.jsx)(S.default,{onPress:function(){return A(null)},children:"Cancel"}),Object(E.jsx)(S.default,{onPress:V,children:"Save"})]})]})})]})},on=x.default.create({container:{flex:1},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},filters:{padding:16},dateFilters:{flexDirection:"row",justifyContent:"space-between",marginBottom:16},statusChips:{flexDirection:"row",paddingVertical:8},chip:{marginRight:8}}),ln=n(141),sn=n(633),un={getCampaignStats:function(){var e=g()((function*(e){var t=(new Date).toISOString().split("T")[0],n=yield D.from("call_records").select("id").eq("campaign_id",e).eq("status","in_progress"),r=n.data,a=n.error,i=yield D.from("call_records").select("id").eq("campaign_id",e).eq("status","pending"),c=i.data,o=i.error,l=yield D.from("call_records").select("status, duration").eq("campaign_id",e).gte("created_at",t),s=l.data,u=l.error;if(a||o||u)throw new Error("Failed to fetch monitoring stats");var d=(null==s?void 0:s.filter((function(e){return"completed"===e.status})))||[],f=(null==s?void 0:s.filter((function(e){return"failed"===e.status})))||[],j=d.reduce((function(e,t){return e+(t.duration||0)}),0);return{activeCallsCount:(null==r?void 0:r.length)||0,queuedCallsCount:(null==c?void 0:c.length)||0,completedCallsToday:d.length,failedCallsToday:f.length,averageCallDuration:d.length?Math.round(j/d.length):0}}));return function(t){return e.apply(this,arguments)}}(),getLiveCalls:function(){var e=g()((function*(e){var t=yield D.from("call_records").select("\n        id,\n        campaign_id,\n        contact_id,\n        status,\n        start_time,\n        duration,\n        contacts (\n          first_name,\n          last_name,\n          phone_number\n        )\n      ").eq("campaign_id",e).in("status",["connecting","in-progress"]).order("start_time",{ascending:!1}),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),subscribeToLiveCalls:function(e,t){var n=D.channel("campaign-"+e).on("postgres_changes",{event:"*",schema:"public",table:"call_records",filter:"campaign_id=eq."+e},(function(e){t(e.new)})).subscribe();return function(){n.unsubscribe()}},getCallRecording:function(){var e=g()((function*(e){var t=yield D.from("call_records").select("recording_url").eq("id",e).single(),n=t.data,r=t.error;if(r)throw r;return(null==n?void 0:n.recording_url)||null}));return function(t){return e.apply(this,arguments)}}()},dn=function(e){var t=e.route.params.id,n=Object(r.useState)(null),a=y()(n,2),i=a[0],c=a[1],o=Object(r.useState)([]),l=y()(o,2),s=l[0],u=l[1],d=Object(r.useState)(!0),f=y()(d,2),j=(f[0],f[1]),p=Object(r.useState)(!1),b=y()(p,2),h=b[0],m=b[1],O=Object(r.useState)(""),x=y()(O,2),w=x[0],_=x[1],P=Object(r.useState)(null),D=y()(P,2),T=(D[0],D[1],Object(r.useState)(null)),I=y()(T,2),k=I[0],B=I[1],A=Object(r.useMemo)((function(){return{activeCallsCount:(null==i?void 0:i.activeCallsCount)||0,queuedCallsCount:(null==i?void 0:i.queuedCallsCount)||0,completedCallsToday:(null==i?void 0:i.completedCallsToday)||0,failedCallsToday:(null==i?void 0:i.failedCallsToday)||0}}),[i]);Object(r.useEffect)((function(){M();var e=un.subscribeToLiveCalls(t,R);return function(){e(),k&&k.unloadAsync()}}),[t]);var M=function(){var e=g()((function*(){try{j(!0);var e=yield Promise.all([un.getCampaignStats(t),un.getLiveCalls(t)]),n=y()(e,2),r=n[0],a=n[1];c(r),u(a)}catch(i){_(i.message||"Failed to load monitoring data")}finally{j(!1)}}));return function(){return e.apply(this,arguments)}}(),R=function(e){u((function(t){var n=t.findIndex((function(t){return t.id===e.id}));if(n>=0){var r=z()(t);return r[n]=e,r}return[e].concat(z()(t))}))},q=Object(r.useCallback)(g()((function*(){m(!0),yield M(),m(!1)})),[M]),F=function(){var e=g()((function*(e){try{var t=yield un.getCallRecording(e);if(!t)throw new Error("No recording available");k&&(yield k.unloadAsync());var n=(yield sn.Audio.Sound.createAsync({uri:t},{shouldPlay:!0})).sound;B(n)}catch(r){_(r.message||"Failed to play recording")}}));return function(t){return e.apply(this,arguments)}}();return Object(E.jsxs)(ee.default,{style:fn.container,refreshControl:Object(E.jsx)(ln.default,{refreshing:h,onRefresh:q}),children:[Object(E.jsxs)(v.default,{style:fn.statsGrid,children:[Object(E.jsx)(L.default,{style:fn.statsCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Active Calls"}),Object(E.jsx)(C.default,{variant:"displaySmall",children:A.activeCallsCount})]})}),Object(E.jsx)(L.default,{style:fn.statsCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"In Queue"}),Object(E.jsx)(C.default,{variant:"displaySmall",children:A.queuedCallsCount})]})}),Object(E.jsx)(L.default,{style:fn.statsCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Completed Today"}),Object(E.jsx)(C.default,{variant:"displaySmall",children:A.completedCallsToday})]})}),Object(E.jsx)(L.default,{style:fn.statsCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Failed Today"}),Object(E.jsx)(C.default,{variant:"displaySmall",children:A.failedCallsToday})]})})]}),Object(E.jsxs)(L.default,{style:fn.tableCard,children:[Object(E.jsx)(L.default.Title,{title:"Live Calls"}),Object(E.jsx)(L.default.Content,{children:Object(E.jsxs)(Gt.default,{children:[Object(E.jsxs)(Gt.default.Header,{children:[Object(E.jsx)(Gt.default.Title,{children:"Contact"}),Object(E.jsx)(Gt.default.Title,{children:"Status"}),Object(E.jsx)(Gt.default.Title,{numeric:!0,children:"Duration"}),Object(E.jsx)(Gt.default.Title,{})]}),s.map((function(e){return Object(E.jsxs)(Gt.default.Row,{children:[Object(E.jsxs)(Gt.default.Cell,{children:[e.contact.first_name," ",e.contact.last_name]}),Object(E.jsx)(Gt.default.Cell,{children:e.status}),Object(E.jsxs)(Gt.default.Cell,{numeric:!0,children:[e.duration,"s"]}),Object(E.jsx)(Gt.default.Cell,{children:Object(E.jsx)(G.default,{icon:"play",onPress:function(){return F(e.id)}})})]},e.id)}))]})})]}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:!!w,onDismiss:function(){return _("")},children:[Object(E.jsx)(K.default.Title,{children:"Error"}),Object(E.jsx)(K.default.Content,{children:Object(E.jsx)(C.default,{children:w})}),Object(E.jsx)(K.default.Actions,{children:Object(E.jsx)(S.default,{onPress:function(){return _("")},children:"OK"})})]})})]})},fn=x.default.create({container:{flex:1},statsGrid:{flexDirection:"row",flexWrap:"wrap",padding:8},statsCard:{flex:1,margin:8,minWidth:150},tableCard:{margin:16}}),jn=n(43),pn=n(302),bn={getPerformanceMetrics:function(){var e=g()((function*(e,t){var n,r=new Date;switch(t){case"day":n=new Date(r.setDate(r.getDate()-1));break;case"week":n=new Date(r.setDate(r.getDate()-7));break;case"month":n=new Date(r.setMonth(r.getMonth()-1))}var a=yield D.from("call_records").select("*").eq("campaign_id",e).gte("created_at",n.toISOString()).order("created_at"),i=a.data,c=a.error;if(c)throw c;var o=i.length,l=i.filter((function(e){return"completed"===e.status})).length,s=i.filter((function(e){return"converted"===e.outcome})).length,u=i.reduce((function(e,t){return e+(t.duration||0)}),0),d=i.reduce((function(e,t){return e+(t.cost||0)}),0),f=i.reduce((function(e,t){var n=new Date(t.created_at).toLocaleDateString();return e[n]=(e[n]||0)+1,e}),{}),j=i.reduce((function(e,t){return e[t.status]=(e[t.status]||0)+1,e}),{}),p=Array.from({length:24},(function(e,t){return i.filter((function(e){return new Date(e.created_at).getHours()===t&&"completed"===e.status})).length}));return{successRate:o?l/o*100:0,conversionRate:o?s/o*100:0,avgDuration:o?Math.round(u/o):0,costPerCall:o?Math.round(d/o*100)/100:0,callVolumeTrend:{labels:Object.keys(f),datasets:[{data:Object.values(f)}]},callOutcomes:Object.entries(j).map((function(e){var t=y()(e,2),n=t[0];return{name:n,value:t[1],color:hn(n),legendFontColor:"#7F7F7F"}})),bestCallingHours:{labels:Array.from({length:24},(function(e,t){return t.toString()})),datasets:[{data:p}]}}}));return function(t,n){return e.apply(this,arguments)}}()},hn=function(e){switch(e){case"completed":return"#4CAF50";case"failed":return"#F44336";case"no-answer":return"#FFC107";case"voicemail":return"#2196F3";default:return"#9E9E9E"}},mn=function(e){var t=e.route.params.id,n=Object(r.useState)(null),a=y()(n,2),i=a[0],c=a[1],o=Object(r.useState)(!0),l=y()(o,2),s=l[0],u=l[1],d=Object(r.useState)("week"),f=y()(d,2),j=f[0],p=f[1];Object(r.useEffect)((function(){b()}),[t,j]);var b=function(){var e=g()((function*(){try{u(!0);var e=yield bn.getPerformanceMetrics(t,j);c(e)}catch(n){console.error("Error loading metrics:",n)}finally{u(!1)}}));return function(){return e.apply(this,arguments)}}();return s||!i?Object(E.jsx)(v.default,{style:gn.centered,children:Object(E.jsx)(It.default,{size:"large"})}):Object(E.jsxs)(ee.default,{style:gn.container,children:[Object(E.jsx)(v.default,{style:gn.header,children:Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Campaign Performance"})}),Object(E.jsx)(v.default,{style:gn.timeRangeButtons,children:["day","week","month"].map((function(e){return Object(E.jsx)(S.default,{mode:j===e?"contained":"outlined",onPress:function(){return p(e)},style:gn.timeButton,children:e.charAt(0).toUpperCase()+e.slice(1)},e)}))}),Object(E.jsxs)(v.default,{style:gn.metricsGrid,children:[Object(E.jsx)(L.default,{style:gn.metricCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Success Rate"}),Object(E.jsxs)(C.default,{variant:"displaySmall",children:[i.successRate,"%"]})]})}),Object(E.jsx)(L.default,{style:gn.metricCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Conversion Rate"}),Object(E.jsxs)(C.default,{variant:"displaySmall",children:[i.conversionRate,"%"]})]})}),Object(E.jsx)(L.default,{style:gn.metricCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Avg Call Duration"}),Object(E.jsxs)(C.default,{variant:"displaySmall",children:[i.avgDuration,"s"]})]})}),Object(E.jsx)(L.default,{style:gn.metricCard,children:Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Cost per Call"}),Object(E.jsxs)(C.default,{variant:"displaySmall",children:["$",i.costPerCall]})]})})]}),Object(E.jsxs)(L.default,{style:gn.chartCard,children:[Object(E.jsx)(L.default.Title,{title:"Call Volume Trend"}),Object(E.jsx)(L.default.Content,{children:Object(E.jsx)(pn.LineChart,{data:i.callVolumeTrend,width:jn.default.get("window").width-32,height:220,chartConfig:{backgroundColor:"#ffffff",backgroundGradientFrom:"#ffffff",backgroundGradientTo:"#ffffff",decimalPlaces:0,color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(43, 58, 103, "+e+")"}},bezier:!0,style:gn.chart})})]}),Object(E.jsxs)(L.default,{style:gn.chartCard,children:[Object(E.jsx)(L.default.Title,{title:"Call Outcomes"}),Object(E.jsx)(L.default.Content,{children:Object(E.jsx)(pn.PieChart,{data:i.callOutcomes,width:jn.default.get("window").width-32,height:220,chartConfig:{color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(43, 58, 103, "+e+")"}},accessor:"value",backgroundColor:"transparent",paddingLeft:"15"})})]}),Object(E.jsxs)(L.default,{style:gn.chartCard,children:[Object(E.jsx)(L.default.Title,{title:"Best Calling Hours"}),Object(E.jsx)(L.default.Content,{children:Object(E.jsx)(pn.BarChart,{data:i.bestCallingHours,width:jn.default.get("window").width-32,height:220,chartConfig:{backgroundColor:"#ffffff",backgroundGradientFrom:"#ffffff",backgroundGradientTo:"#ffffff",decimalPlaces:0,color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(123, 104, 238, "+e+")"}},style:gn.chart})})]})]})},gn=x.default.create({container:{flex:1},centered:{flex:1,justifyContent:"center",alignItems:"center"},header:{padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},timeRangeButtons:{flexDirection:"row",justifyContent:"center",padding:16,gap:8},timeButton:{flex:1},metricsGrid:{flexDirection:"row",flexWrap:"wrap",padding:8},metricCard:{flex:1,margin:8,minWidth:150},chartCard:{margin:16},chart:{marginVertical:8,borderRadius:16}}),On=n(148),yn=n(184),vn=n(1060),xn=n(1050),Cn=n(1051),wn=n(1052);function Sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sn(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pn={initialize:function(){var e=g()((function*(){yield vn.requestPermissionsAsync(),yield xn.default("default",{name:"default",importance:Cn.AndroidImportance.MAX,vibrationPattern:[0,250,250,250]})}));return function(){return e.apply(this,arguments)}}(),getNotifications:function(){var e=g()((function*(e){var t=yield D.from("notifications").select("*").eq("user_id",e).order("created_at",{ascending:!1}),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),sendNotification:function(){var e=g()((function*(e,t){var n=yield D.from("notifications").insert([_n(_n({},t),{},{user_id:e,read:!1})]).select().single(),r=n.data,a=n.error;if(a)throw a;var i=(yield D.from("notification_configs").select("*").eq("user_id",e).eq("type",t.type).single()).data;return null!=i&&i.enabled&&i.channels.includes("push")&&(yield wn.default({content:{title:t.title,body:t.message,data:t.data},trigger:null})),r}));return function(t,n){return e.apply(this,arguments)}}(),markAsRead:function(){var e=g()((function*(e){var t=(yield D.from("notifications").update({read:!0}).eq("id",e)).error;if(t)throw t}));return function(t){return e.apply(this,arguments)}}(),updateConfig:function(){var e=g()((function*(e,t){var n=(yield D.from("notification_configs").upsert([_n(_n({},t),{},{user_id:e})])).error;if(n)throw n}));return function(t,n){return e.apply(this,arguments)}}()},Dn=n(1053);function Tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tn(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var In=function(){var e=q().user,t=Object(r.useState)([]),n=y()(t,2),a=n[0],i=n[1],c=Object(r.useState)(!0),o=y()(c,2),l=(o[0],o[1]),s=Object(r.useState)(!1),u=y()(s,2),d=u[0],f=u[1],j=Object(r.useState)(null),p=y()(j,2),b=p[0],h=p[1];Object(r.useEffect)((function(){e&&m()}),[e]);var m=function(){var t=g()((function*(){try{l(!0);var t=yield Pn.getNotifications(e.id);i(t)}catch(n){console.error("Error loading notifications:",n)}finally{l(!1)}}));return function(){return t.apply(this,arguments)}}(),O=function(){var e=g()((function*(){f(!0),yield m(),f(!1)}));return function(){return e.apply(this,arguments)}}(),x=function(){var e=g()((function*(e){try{yield Pn.markAsRead(e.id),i((function(t){return t.map((function(t){return t.id===e.id?En(En({},t),{},{read:!0}):t}))}))}catch(t){console.error("Error marking notification as read:",t)}}));return function(t){return e.apply(this,arguments)}}(),w=function(e){switch(e){case"campaign":return"bullhorn";case"call":return"phone";case"quality":return"chart-bar";case"system":return"cog";case"error":return"alert";default:return"bell"}};return Object(E.jsxs)(v.default,{style:kn.container,children:[Object(E.jsx)(ee.default,{refreshControl:Object(E.jsx)(ln.default,{refreshing:d,onRefresh:O}),children:Object(E.jsxs)(Ae.List.Section,{children:[Object(E.jsx)(Ae.List.Subheader,{children:"Recent Notifications"}),a.map((function(e){return Object(E.jsxs)(r.Fragment,{children:[Object(E.jsx)(Ae.List.Item,{title:e.title,description:e.message,left:function(t){return Object(E.jsx)(Ae.List.Icon,En(En({},t),{},{icon:w(e.type)}))},right:function(t){return Object(E.jsxs)(v.default,{style:kn.rightContent,children:[Object(E.jsx)(C.default,{style:kn.timestamp,children:Object(Dn.default)(new Date(e.created_at),{addSuffix:!0})}),!e.read&&Object(E.jsx)(On.default,{size:8,style:kn.unreadBadge})]})},onPress:function(){return h(e)}}),Object(E.jsx)(yn.default,{})]},e.id)}))]})}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:!!b,onDismiss:function(){return h(null)},children:[Object(E.jsx)(K.default.Title,{children:null==b?void 0:b.title}),Object(E.jsxs)(K.default.Content,{children:[Object(E.jsx)(C.default,{children:null==b?void 0:b.message}),(null==b?void 0:b.data)&&Object(E.jsx)(v.default,{style:kn.metadata,children:Object.entries(b.data).map((function(e){var t=y()(e,2),n=t[0],r=t[1];return Object(E.jsxs)(C.default,{style:kn.metadataItem,children:[n,": ",r]},n)}))})]}),Object(E.jsxs)(K.default.Actions,{children:[!(null!=b&&b.read)&&Object(E.jsx)(S.default,{onPress:function(){b&&x(b),h(null)},children:"Mark as Read"}),Object(E.jsx)(S.default,{onPress:function(){return h(null)},children:"Close"})]})]})})]})},kn=x.default.create({container:{flex:1},rightContent:{flexDirection:"row",alignItems:"center",gap:8},timestamp:{fontSize:12,color:"#666"},unreadBadge:{backgroundColor:"#2196F3"},metadata:{marginTop:16,padding:8,backgroundColor:"#f5f5f5",borderRadius:4},metadataItem:{fontSize:14,marginBottom:4}});function Bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function An(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bn(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ln=function(){var e=q().user,t=Object(r.useState)([]),n=y()(t,2),a=n[0],i=n[1],c=Object(r.useState)(!0),o=y()(c,2),l=(o[0],o[1]),s=Object(r.useState)(null),u=y()(s,2),d=u[0],f=u[1];Object(r.useEffect)((function(){e&&j()}),[e]);var j=function(){var t=g()((function*(){try{l(!0);var t=yield Pn.getConfigs(e.id);i(t)}catch(n){console.error("Error loading notification configs:",n)}finally{l(!1)}}));return function(){return t.apply(this,arguments)}}(),p=function(){var t=g()((function*(t){try{yield Pn.updateConfig(e.id,An(An({},t),{},{enabled:!t.enabled})),i((function(e){return e.map((function(e){return e.id===t.id?An(An({},e),{},{enabled:!e.enabled}):e}))}))}catch(n){console.error("Error updating notification config:",n)}}));return function(e){return t.apply(this,arguments)}}(),b=function(){var t=g()((function*(t,n){var r=t.channels.includes(n)?t.channels.filter((function(e){return e!==n})):[].concat(z()(t.channels),[n]);try{yield Pn.updateConfig(e.id,An(An({},t),{},{channels:r})),i((function(e){return e.map((function(e){return e.id===t.id?An(An({},e),{},{channels:r}):e}))}))}catch(a){console.error("Error updating notification channels:",a)}}));return function(e,n){return t.apply(this,arguments)}}();return Object(E.jsxs)(ee.default,{style:Mn.container,children:[Object(E.jsxs)(Ae.List.Section,{children:[Object(E.jsx)(Ae.List.Subheader,{children:"Notification Preferences"}),a.map((function(e){return Object(E.jsxs)(r.Fragment,{children:[Object(E.jsx)(Ae.List.Item,{title:e.type.charAt(0).toUpperCase()+e.type.slice(1),description:e.channels.length+" channels enabled",onPress:function(){return f(e)},right:function(){return Object(E.jsx)(ne.default,{value:e.enabled,onValueChange:function(){return p(e)}})}}),Object(E.jsx)(yn.default,{})]},e.id)}))]}),Object(E.jsx)(J.default,{children:Object(E.jsxs)(K.default,{visible:!!d,onDismiss:function(){return f(null)},children:[Object(E.jsxs)(K.default.Title,{children:[(null==d?void 0:d.type.charAt(0).toUpperCase())+(null==d?void 0:d.type.slice(1))," Notifications"]}),Object(E.jsxs)(K.default.Content,{children:[Object(E.jsx)(Ae.List.Item,{title:"Push Notifications",right:function(){return Object(E.jsx)(ne.default,{value:null==d?void 0:d.channels.includes("push"),onValueChange:function(){return d&&b(d,"push")}})}}),Object(E.jsx)(Ae.List.Item,{title:"Email Notifications",right:function(){return Object(E.jsx)(ne.default,{value:null==d?void 0:d.channels.includes("email"),onValueChange:function(){return d&&b(d,"email")}})}}),Object(E.jsx)(Ae.List.Item,{title:"In-App Notifications",right:function(){return Object(E.jsx)(ne.default,{value:null==d?void 0:d.channels.includes("in-app"),onValueChange:function(){return d&&b(d,"in-app")}})}})]}),Object(E.jsx)(K.default.Actions,{children:Object(E.jsx)(S.default,{onPress:function(){return f(null)},children:"Done"})})]})})]})},Mn=x.default.create({container:{flex:1}}),Rn={generateReport:function(){var e=g()((function*(e,t,n){try{var r=(yield D.from("report_templates").select("*").eq("id",t).single()).data,a=yield qn(e,r.metrics),i=yield Fn(a,r.layout,n),c=yield D.from("reports").insert([{template_id:t,campaign_id:e,data:a,format:n,file_url:i.url}]).select().single(),o=c.data,l=c.error;if(l)throw l;return o}catch(l){throw new Error("Failed to generate report: "+l.message)}}));return function(t,n,r){return e.apply(this,arguments)}}(),getReportTemplates:function(){var e=g()((function*(){var e=yield D.from("report_templates").select("*"),t=e.data,n=e.error;if(n)throw n;return t}));return function(){return e.apply(this,arguments)}}(),createTemplate:function(){var e=g()((function*(e){var t=yield D.from("report_templates").insert([e]).select().single(),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}(),getReports:function(){var e=g()((function*(e){var t=yield D.from("reports").select("*").eq("campaign_id",e).order("generated_at",{ascending:!1}),n=t.data,r=t.error;if(r)throw r;return n}));return function(t){return e.apply(this,arguments)}}()},qn=function(){var e=g()((function*(e,t){}));return function(t,n){return e.apply(this,arguments)}}(),Fn=function(){var e=g()((function*(e,t,n){}));return function(t,n,r){return e.apply(this,arguments)}}();function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zn=function(){var e=Object(r.useState)([]),t=y()(e,2),n=t[0],a=t[1],i=Object(r.useState)(null),c=y()(i,2),o=c[0],l=c[1],u=Object(r.useState)({start:new Date,end:new Date}),d=y()(u,2),f=d[0],j=d[1],p=Object(r.useState)("pdf"),b=y()(p,2),h=b[0],m=b[1],O=Object(r.useState)(!1),x=y()(O,2),w=x[0],_=x[1],P=Object(r.useState)(null),D=y()(P,2),T=D[0],I=D[1];Object(r.useEffect)((function(){k()}),[]);var k=function(){var e=g()((function*(){try{var e=yield Rn.getReportTemplates();a(e)}catch(t){console.error("Error loading templates:",t)}}));return function(){return e.apply(this,arguments)}}(),B=function(){var e=g()((function*(){if(o)try{_(!0),yield Rn.generateReport(o,h)}catch(e){console.error("Error generating report:",e)}finally{_(!1)}}));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(ee.default,{style:Hn.container,children:[Object(E.jsxs)(L.default,{style:Hn.card,children:[Object(E.jsx)(L.default.Title,{title:"Report Generator"}),Object(E.jsxs)(L.default.Content,{children:[Object(E.jsx)(C.default,{variant:"titleMedium",children:"Select Template"}),Object(E.jsx)(v.default,{style:Hn.templatesGrid,children:n.map((function(e){return Object(E.jsx)(te.default,{selected:o===e.id,onPress:function(){return l(e.id)},style:Hn.templateChip,children:e.name},e.id)}))}),Object(E.jsx)(C.default,{variant:"titleMedium",style:Hn.sectionTitle,children:"Date Range"}),Object(E.jsxs)(v.default,{style:Hn.dateContainer,children:[Object(E.jsx)(S.default,{mode:"outlined",onPress:function(){return I("start")},children:f.start.toLocaleDateString()}),Object(E.jsx)(C.default,{children:"to"}),Object(E.jsx)(S.default,{mode:"outlined",onPress:function(){return I("end")},children:f.end.toLocaleDateString()})]}),Object(E.jsx)(C.default,{variant:"titleMedium",style:Hn.sectionTitle,children:"Format"}),Object(E.jsx)(_e.default,{value:h,onValueChange:function(e){return m(e)},buttons:[{value:"pdf",label:"PDF"},{value:"csv",label:"CSV"},{value:"excel",label:"Excel"}]})]}),Object(E.jsx)(L.default.Actions,{children:Object(E.jsx)(S.default,{mode:"contained",onPress:B,loading:w,disabled:!o||w,children:"Generate Report"})})]}),T&&Object(E.jsx)(Ce.DateTimePicker,{value:"start"===T?f.start:f.end,mode:"date",onChange:function(e,t){I(null),t&&j((function(e){return Vn(Vn({},e),{},s()({},T,t))}))}})]})},Hn=x.default.create({container:{flex:1,padding:16},card:{marginBottom:16},templatesGrid:{flexDirection:"row",flexWrap:"wrap",gap:8,marginVertical:8},templateChip:{marginBottom:8},sectionTitle:{marginTop:16,marginBottom:8},dateContainer:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:16}});function Gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gn(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wn={assignContactsToCampaign:function(){var e=g()((function*(e,t){var n=(yield D.from("campaign_contacts").insert(t.map((function(t){return{campaign_id:e,contact_id:t}})))).error;if(n)throw n}));return function(t,n){return e.apply(this,arguments)}}(),createSegment:function(){var e=g()((function*(e,t){var n=yield D.from("contact_segments").insert([{name:e,rules:t}]).select().single(),r=n.data,a=n.error;if(a)throw a;var i=yield Jn(t);return yield D.from("contact_segments").update({contact_count:i.length}).eq("id",r.id),Un(Un({},r),{},{contact_count:i.length})}));return function(t,n){return e.apply(this,arguments)}}(),getSegmentContacts:function(){var e=g()((function*(e){var t=(yield D.from("contact_segments").select("rules").eq("id",e).single()).data;return Jn(t.rules)}));return function(t){return e.apply(this,arguments)}}(),setPriority:function(){var e=g()((function*(e,t,n,r){var a=(yield D.from("contact_priorities").upsert([{campaign_id:e,contact_id:t,priority:n,reason:r}])).error;if(a)throw a}));return function(t,n,r,a){return e.apply(this,arguments)}}(),getNextContacts:function(){var e=g()((function*(e,t){var n=yield D.from("campaign_contacts").select("\n        contacts (*),\n        contact_priorities (priority)\n      ").eq("campaign_id",e).eq("status","pending").order("contact_priorities.priority",{ascending:!1}).limit(t),r=n.data,a=n.error;if(a)throw a;return r.map((function(e){return e.contacts}))}));return function(t,n){return e.apply(this,arguments)}}()},Jn=function(){var e=g()((function*(e){var t=D.from("contacts").select("*");e.forEach((function(e){switch(e.operator){case"equals":t=t.eq(e.field,e.value);break;case"contains":t=t.ilike(e.field,"%"+e.value+"%");break;case"greater_than":t=t.gt(e.field,e.value);break;case"less_than":t=t.lt(e.field,e.value)}}));var n=yield t,r=n.data,a=n.error;if(a)throw a;return r}));return function(t){return e.apply(this,arguments)}}();function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zn=function(){var e=Object(r.useState)([]),t=y()(e,2),n=t[0],a=t[1],i=Object(r.useState)(!1),c=y()(i,2),o=c[0],l=c[1],s=Object(r.useState)({name:"",rules:[]}),u=y()(s,2),d=u[0],f=u[1],j=Object(r.useState)(null),p=y()(j,2),b=p[0],h=p[1],m=Object(r.useCallback)(g()((function*(){try{var e=yield Wn.getSegments();a(e)}catch(t){console.error("Error loading segments:",t)}})),[]);Object(r.useEffect)((function(){m()}),[m]);var O=function(){var e=g()((function*(){try{yield Wn.createSegment(d.name,d.rules),l(!1),f({name:"",rules:[]}),yield m()}catch(e){console.error("Error creating segment:",e)}}));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(ee.default,{style:Xn.container,children:[Object(E.jsxs)(v.default,{style:Xn.header,children:[Object(E.jsx)(C.default,{variant:"headlineMedium",children:"Contact Segments"}),Object(E.jsx)(S.default,{mode:"contained",onPress:function(){return l(!0)},children:"Create Segment"})]}),n.map((function(e){return Object(E.jsxs)(L.default,{style:Xn.segmentCard,onPress:function(){return h(e)},children:[Object(E.jsx)(L.default.Title,{title:e.name,subtitle:e.contact_count+" contacts"}),Object(E.jsx)(L.default.Content,{children:Object(E.jsx)(v.default,{style:Xn.rulesContainer,children:e.rules.map((function(e,t){return Object(E.jsx)(te.default,{style:Xn.ruleChip,children:e.field+" "+e.operator+" "+e.value},t)}))})})]},e.id)})),Object(E.jsxs)(J.default,{children:[Object(E.jsxs)(K.default,{visible:o,onDismiss:function(){return l(!1)},children:[Object(E.jsx)(K.default.Title,{children:"Create Segment"}),Object(E.jsxs)(K.default.Content,{children:[Object(E.jsx)(w.default,{label:"Segment Name",value:d.name,onChangeText:function(e){return f((function(t){return Yn(Yn({},t),{},{name:e})}))},style:Xn.input}),d.rules.map((function(e,t){return Object(E.jsxs)(v.default,{style:Xn.ruleInput,children:[Object(E.jsx)(w.default,{label:"Field",value:e.field,onChangeText:function(e){var n=z()(d.rules);n[t].field=e,f((function(e){return Yn(Yn({},e),{},{rules:n})}))},style:Xn.fieldInput}),Object(E.jsx)(w.default,{label:"Value",value:e.value,onChangeText:function(e){var n=z()(d.rules);n[t].value=e,f((function(e){return Yn(Yn({},e),{},{rules:n})}))},style:Xn.valueInput}),Object(E.jsx)(G.default,{icon:"delete",onPress:function(){var e=d.rules.filter((function(e,n){return n!==t}));f((function(t){return Yn(Yn({},t),{},{rules:e})}))}})]},t)})),Object(E.jsx)(S.default,{mode:"outlined",onPress:function(){f((function(e){return Yn(Yn({},e),{},{rules:[].concat(z()(e.rules),[{field:"",operator:"equals",value:""}])})}))},style:Xn.addRuleButton,children:"Add Rule"})]}),Object(E.jsxs)(K.default.Actions,{children:[Object(E.jsx)(S.default,{onPress:function(){return l(!1)},children:"Cancel"}),Object(E.jsx)(S.default,{onPress:O,children:"Create"})]})]}),Object(E.jsxs)(K.default,{visible:!!b,onDismiss:function(){return h(null)},children:[Object(E.jsx)(K.default.Title,{children:null==b?void 0:b.name}),Object(E.jsx)(K.default.Content,{children:Object(E.jsxs)(Ae.List.Section,{children:[Object(E.jsx)(Ae.List.Subheader,{children:"Rules"}),null==b?void 0:b.rules.map((function(e,t){return Object(E.jsx)(Ae.List.Item,{title:e.field+" "+e.operator+" "+e.value,left:function(e){return Object(E.jsx)(Ae.List.Icon,Yn(Yn({},e),{},{icon:"filter"}))}},t)}))]})}),Object(E.jsx)(K.default.Actions,{children:Object(E.jsx)(S.default,{onPress:function(){return h(null)},children:"Close"})})]})]})]})},Xn=x.default.create({container:{flex:1,padding:16},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},segmentCard:{marginBottom:16},rulesContainer:{flexDirection:"row",flexWrap:"wrap",gap:8},ruleChip:{marginBottom:8},input:{marginBottom:16},ruleInput:{flexDirection:"row",alignItems:"center",marginBottom:8},fieldInput:{flex:1,marginRight:8},valueInput:{flex:1,marginRight:8},addRuleButton:{marginTop:8}}),Qn=Object(h.default)(),$n=function(){return Object(E.jsxs)(Qn.Navigator,{screenOptions:{headerShown:!1},children:[Object(E.jsx)(Qn.Screen,{name:"SignIn",component:I}),Object(E.jsx)(Qn.Screen,{name:"SignUp",component:B})]})},er=function(){return Object(E.jsxs)(Qn.Navigator,{screenOptions:{headerShown:!1},children:[Object(E.jsx)(Qn.Screen,{name:"Dashboard",component:F}),Object(E.jsx)(Qn.Screen,{name:"Contacts",component:ue}),Object(E.jsx)(Qn.Screen,{name:"Campaigns",component:ve}),Object(E.jsx)(Qn.Screen,{name:"CampaignCreate",component:Ge}),Object(E.jsx)(Qn.Screen,{name:"CampaignEdit",component:ht}),Object(E.jsx)(Qn.Screen,{name:"ContactLists",component:yt,options:{title:"Contact Lists",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"ContactListDetail",component:Tt,options:{title:"List Details",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"ContactAnalytics",component:Lt,options:{title:"Analytics",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"CampaignAnalytics",component:Nt,options:{title:"Campaign Analytics",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"CampaignSettings",component:zt,options:{title:"Campaign Settings",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"CallHistory",component:cn,options:{title:"Call History",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"CampaignMonitor",component:dn,options:{title:"Campaign Monitor",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"CampaignPerformance",component:mn,options:{title:"Campaign Performance",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"NotificationCenter",component:In,options:{title:"Notifications",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"NotificationSettings",component:Ln,options:{title:"Notification Settings",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"ReportGenerator",component:zn,options:{title:"Generate Report",headerShown:!0}}),Object(E.jsx)(Qn.Screen,{name:"ContactSegmentation",component:Zn,options:{title:"Contact Segments",headerShown:!0}})]})},tr=function(){var e=q(),t=e.user;return e.loading?Object(E.jsx)(v.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(E.jsx)(we.default,{size:"large"})}):Object(E.jsx)(b.default,{children:t?Object(E.jsx)(er,{}):Object(E.jsx)($n,{})})};function nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ar={createCallRecord:function(){var e=g()((function*(e,t){var n=yield D.from("call_records").insert([{campaign_id:e,contact_id:t,status:"pending",attempt_count:0}]).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),updateCallRecord:function(){var e=g()((function*(e,t){var n=yield D.from("call_records").update(rr(rr({},t),{},{updated_at:(new Date).toISOString()})).eq("id",e).select().single(),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),getPendingCalls:function(){var e=g()((function*(e,t){var n=yield D.from("call_records").select("*").eq("campaign_id",e).eq("status","pending").order("created_at").limit(t),r=n.data,a=n.error;if(a)throw a;return r}));return function(t,n){return e.apply(this,arguments)}}(),executeCall:function(){var e=g()((function*(e,t,n){try{var r=Math.floor(300*Math.random())+60,a=Math.random()>.2;return{success:a,duration:r,notes:a?"Call completed successfully":"Call failed"}}catch(i){throw new Error("Call execution failed: "+i.message)}}));return function(t,n,r){return e.apply(this,arguments)}}(),processCallQueue:function(){var e=g()((function*(e){try{var t=yield D.from("campaigns").select("*, campaign_settings(*)").eq("id",e).single(),n=t.data,r=t.error;if(r)throw r;var a=yield ar.getPendingCalls(e,n.settings.max_concurrent_calls);for(var i of a){var c=yield ar.executeCall(i,n.script,n.settings.voice_settings.voice_id);yield ar.updateCallRecord(i.id,{status:c.success?"completed":"failed",attempt_count:i.attempt_count+1,last_attempt:(new Date).toISOString(),next_attempt:c.success?null:new Date(Date.now()+6e4*n.settings.call_handling.retry_interval).toISOString(),duration:c.duration,recording_url:c.recording_url,notes:c.notes})}}catch(o){throw console.error("Error processing call queue:",o),o}}));return function(t){return e.apply(this,arguments)}}()},ir={schedules:{campaignProcessor:{lastRun:new Date,interval:6e4},scheduleChecker:{lastRun:new Date,interval:3e5}},processCampaigns:function(){var e=g()((function*(){try{var e=(yield ye.getCampaigns()).filter((function(e){return"active"===e.status}));for(var t of e){var n=yield me.getSchedule(t.id);if(n&&"active"===n.status){var r=new Date,a=100*r.getHours()+r.getMinutes(),i=parseInt(n.daily_start_time.replace(":","")),c=parseInt(n.daily_end_time.replace(":",""));if(!(a<i||a>c)){if("recurring"===n.schedule_type&&n.days_of_week){var o=r.getDay();if(!n.days_of_week.includes(o))continue}yield ar.processCallQueue(t.id)}}}}catch(l){throw console.error("Error processing campaigns:",l),l}}));return function(){return e.apply(this,arguments)}}(),checkSchedules:function(){var e=g()((function*(){try{var e=yield ye.getCampaigns();for(var t of e){var n=yield me.getSchedule(t.id);if(n){var r=new Date,a=new Date(n.start_date),i=n.end_date?new Date(n.end_date):null;"draft"===t.status&&r>=a&&(yield ye.updateStatus(t.id,"active")),"active"===t.status&&i&&r>=i&&(yield ye.updateStatus(t.id,"completed"))}}}catch(c){throw console.error("Error checking schedules:",c),c}}));return function(){return e.apply(this,arguments)}}(),runTask:function(){var e=g()((function*(e,t){var n=ir.schedules[e],r=new Date;if(r.getTime()-n.lastRun.getTime()>=n.interval)try{yield t(),n.lastRun=r}catch(a){console.error("Error running task "+e+":",a)}}));return function(t,n){return e.apply(this,arguments)}}(),startTaskManager:function(){setInterval((function(){ir.runTask("campaignProcessor",ir.processCampaigns),ir.runTask("scheduleChecker",ir.checkSchedules)}),6e4),console.log("Task Manager started")},stopTaskManager:function(){for(var e=setInterval((function(){}),0),t=0;t<e;t++)clearInterval(t);console.log("Task Manager stopped")}},cr=x.default.create({webContainer:{maxWidth:1200,marginHorizontal:"auto",width:"100%"},webScrollView:{height:"100vh",overflowY:"auto"},webCard:{boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),or=function(e){var t=e.children;return Object(E.jsx)(v.default,{style:[lr.container,cr.webContainer],children:t})},lr=x.default.create({container:{flex:1,padding:20}}),sr=function(){return function(){var e=q().user;Object(r.useEffect)((function(){if(e)return ir.startTaskManager(),function(){ir.stopTaskManager()}}),[e])}(),Object(E.jsx)(tr,{})};function ur(){return Object(E.jsx)(o.SafeAreaProvider,{children:Object(E.jsx)(c.default,{theme:p,children:Object(E.jsx)(R,{children:"web"===i.default.OS?Object(E.jsx)(or,{children:Object(E.jsx)(sr,{})}):Object(E.jsx)(sr,{})})})})}},652:function(e,t,n){e.exports=n(653)},927:function(e,t){},929:function(e,t){},960:function(e,t){},962:function(e,t){},963:function(e,t){},968:function(e,t){},970:function(e,t){},990:function(e,t){}},[[652,1,2]]]);
//# sourceMappingURL=app.876b2f29.chunk.js.map